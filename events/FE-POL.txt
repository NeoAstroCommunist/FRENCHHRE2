namespace = flavor_pol
namespace = flavor_hun


#Make Louis The Great Heir
country_event = { 
	id = flavor_pol.499
	title = "flavor_pol.3021b.title"
	desc = "flavor_pol.3021b.desc"
	picture = POLICY_eventPicture
	fire_only_once = yes
	is_triggered_only = yes ##on startup
	major = yes
	trigger = { 
		HUN = {
			dynasty = "d'Anjou"
			has_ruler = "Louis the Great"
		}
	}
	
	option = {  						#accept him
		name = "flavor_pol.3021b.a"
		custom_tooltip = tooltip_flavor_pol.3021.a
		ai_chance = { factor = 95 }
		create_alliance = HUN
		set_country_flag = pol_louis_great_heir
		log = "FE-POL:[GetYear]:[Root.GetName]:made Louis d'Anjou heir to Casimir:flavor_pol.499"
	}
	
	option = {							#no louis rawr
		name = "flavor_pol.3021b.b"
		custom_tooltip = tooltip_flavor_pol.3021.b
		ai_chance = { factor = 5 }
		hidden_effect = {
			kill_heir = {}
			PWO = {
				kill_heir = {}
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:rejected Louis d'Anjou as heir to Casimir:flavor_pol.499"
		define_heir = {
			dynasty = "Piast"
			name = "Kazimierz"
			male = yes
			age = 6
			claim = 30
			adm = 2
			dip = 4
			mil = 1
		}
		PWO = {
			define_heir = {
				dynasty = "Gryf"
				name = "Elizabeth"
				male = no
				age = 9
				adm = 3
				dip = 6
				mil = 1
				claim = 20
			}
		}
		HUN = {
			add_trust = { 
				who = POL 
				value = -50
			}
			add_casus_belli = {
				target = POL 
				type = cb_restore_personal_union
				months = 300
			}
			add_opinion = {
				who = POL
				modifier = dishonoured_agreement
			}
		}
		add_prestige = 10
		add_legitimacy = -25
		break_marriage = HUN
	}
}

country_event = { 
	id = flavor_pol.500
	title = "flavor_pol.3023.title"
	desc = "flavor_pol.3023.desc"
	picture = POLICY_eventPicture
	fire_only_once = yes
	is_triggered_only = yes #on monarch death
	hidden = yes
	
		
	immediate = {
		if = {
			limit = {
				NOT = { has_country_flag = pol_louis_great_heir }
			}
		}
		else_if = {										
			limit = {
				OR = {
					HUN = { is_lesser_in_union = yes } 
					POL = { is_lesser_in_union = yes } 
					POL = { senior_union_with = LIT }
				}
			}
		}
		else_if = {                              #normal PU event
			limit = {
				OR = {
					AND = {                     #if pol has not Piast male, checks for HUN having a male too.
						NOT = {
							AND = { 
								has_heir = yes 
								has_female_heir = no
								OR = { 	
									has_regency = yes 
									has_consort_regency = yes
								} 
							}
						}
						NOT = { 
							AND = {
								is_female = no
								dynasty = "Piast"
								OR = { 	
									has_regency = no
									has_consort_regency = no
								} 
							}
						}
						OR = {
							HUN = { is_female = no }
							HUN = { 
								has_heir = yes 
								has_female_heir = no 
								OR = { 
									has_regency = yes
									has_consort_regency = yes
								}
							}
						}
					}
					AND = {
						OR = {      		#pol has woman and hun male 
							AND = {
								is_female = yes
								dynasty = "Piast"
								OR = {
									has_consort_regency = no
									has_regency = no
								}
							}
							AND = { 
								has_heir = yes 
								has_female_heir = yes
								OR = { 	
									has_regency = yes 
									has_consort_regency = yes
								} 
							}
						}
								
						OR = {
							AND = {
								HUN = { 
									is_female = no
									HUN = { dynasty = "d'Anjou" }
									OR = { 
										has_consort_regency = no
										has_regency = no
									}
								}
							}
							HUN = { 
								has_heir = yes 
								has_female_heir = no 
								OR = { 
									has_regency = yes
									has_consort_regency = yes
								}
							}
						}
					}
				}
			}
			country_event = { id = flavor_pol.501 days = 1 }
		}
		else_if = {										#poland got a proper heir!
			limit = {
				OR = {
					AND = {
						has_heir = yes 
						has_female_heir = no #heir is male
						OR = { 	
							has_regency = yes 
							has_consort_regency = yes
						} 
					}
					AND = {
						is_female = no
						dynasty = "Piast"
						OR = { 	
							has_regency = no
							has_consort_regency = no
						} 
					}
				}	
			}
			country_event = { id = flavor_pol.502 days = 1 }
		}
		else_if = { 									#hungary has no male and poland has no piast monarch either female or male.-
			limit = {
				NOT = { dynasty = "Piast" }
				OR = {
					AND = {
						HUN = { 
							is_female = yes
							OR = {
								has_consort_regency = no
								has_regency = no
							}	
						}
					}
					AND = {
						HUN = { 
							has_heir = yes 
							has_female_heir = yes
							OR = {
								has_consort_regency = yes
								has_regency = yes
							}
						}
					}
				}
			}
			country_event = { id = flavor_pol.503 days = 1 }
		}
		else_if = {                                #hungary has no male but poland has piast female monarch-> nothing happens
			limit = {
				OR = {
					AND = {
						is_female = yes
						has_consort_regency = no
						has_regency = no
						dynasty = "Piast"
					}
					OR = {
						HUN = { is_female = yes }
						HUN = { AND = { has_heir = yes has_female_heir = yes OR = { has_regency = yes has_consort_regency = yes } } }
					}
				}
			}
		}
	}
	option = {
		name = no_localisation
	}
	after = {
		clr_country_flag = pol_louis_great_heir
	}
}

country_event = {
	id = flavor_pol.502 #Death of Kazimierz III (with male heir, no union)
	title = "flavor_pol.502.title"
	desc = "flavor_pol.502.desc"
	picture = DEATH_OF_HEIR_eventPicture
	is_triggered_only = yes
	
		
	option = {
		name = "option.flavor_pol.502.a"
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Poland had male heir - no union:flavor_pol.502"		
		add_prestige = 35
		add_legitimacy = 30
		#add_adm_power = 100
		#add_dip_power = 100
		#add_mil_power =  100
	}
}
	
#Death of Kazimierz. Checks if Louis is still alive, has a son or heir. PUs Poland. Won't fire if Poland got a male heir.
country_event = {
	id = flavor_pol.501
	title = "flavor_pol.3022b.title"
	desc = {
		trigger = {
			HUN = { has_ruler = "Louis the Great" } 
		}
		desc = "flavor_pol.3022b.desca"
	}
	desc = {
		trigger = {
			NOT = { HUN = { has_ruler = "Louis the Great" } }
			NOT = { 
				HUN = { has_regency = yes }  
				HUN = { has_consort_regency = yes } 
			}
		}
		desc = "flavor_pol.30222b.descb"
	}
	desc = {
		trigger = {
			NOT = { HUN = { has_ruler = "Louis the Great" } }
			HUN = { 
				has_heir = yes 
				has_female_heir = no 
				OR = { 
					has_regency = yes 
					has_consort_regency = yes 
				} 
			}
		}
		desc = "flavor_pol.302222b.desc"
	}
	
	desc = {
		trigger = {
			is_female = no
			dynasty = "Piast"
		}
		desc = "flavor_pol.3022222b.desc"
	}
	
	picture = DEATH_OF_HEIR_eventPicture
	major = yes
	fire_only_once = yes
	is_triggered_only = yes #fire from on dependency obtained
	trigger = {
		NOT = {
			AND = { 
				has_heir = yes 
				has_female_heir = no
				
				OR = { 	
					has_regency = yes 
					has_consort_regency = yes
				} 
			}
		}
		NOT = { 
			AND = {
				is_female = no
				dynasty = "Piast"
			}
		}
		OR = {
			HUN = { is_female = no }
			HUN = { 
				has_heir = yes 
				has_female_heir = no 
				OR = { 
					has_regency = yes
					has_consort_regency = yes
				}
			}
		}
	}
	immediate = {  }
	
	
	option = { #normal PU when louis alive
		trigger = { HUN = { has_ruler = "Louis the Great" } }
		name = "flavor_pol.3022.a"
		HUN = { create_union = POL }
		set_country_flag = pol_louis_great_king
		add_liberty_desire = 50
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Hungary (with Louis):flavor_pol.501"	
	}
	
	option = { #make new male ruler PU
		name = "flavor_pol.3022c.a"
		ai_chance = { 
			factor = 10
			modifier = { 
				factor = 1.5
				HUN = { legitimacy = 60 }
			}
			modifier = { 
				factor = 2
				HUN = { legitimacy = 85 }
			}	
		}
		trigger = { 
			NOT = { HUN =  { has_ruler = "Louis the Great" } }
			NOT = { 
				HUN = { has_regency = yes }  
				HUN = { has_consort_regency = yes } 
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Hungary (without Louis):flavor_pol.501"	
		HUN = { create_union = POL }
		add_liberty_desire = 100
		set_country_flag = pol_louis_son_great_king
	}
	
	option = { #make male heir PU
		name = "flavor_pol.3022c.b"
		ai_chance = { 
			factor = 10
			modifier = { 
				factor = 1.5
				HUN = { heir_claim = 60 }
			}
			modifier = { 
				factor = 2
				HUN = { heir_claim = 85 }
			}
		}
		trigger = {	
			NOT = { HUN =  { has_ruler = "Louis the Great" } }
			HUN = { 
				has_heir = yes 
				has_female_heir = no 
				OR = { 
					has_regency = yes 
					has_consort_regency = yes 
				} 
			}
		}
		HUN = { create_union = POL }
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Hungary (without Louis):flavor_pol.501"	
		add_liberty_desire = 100
		set_country_flag = pol_louis_son_great_king
	}
	
	
	option = { #politely decline
		name = "flavor_pol.3022c.c"
		ai_chance = { factor = 90 }
		trigger = {
			NOT = { HUN =  { has_ruler = "Louis the Great" } }
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, declined PU under Hungary (without Louis):flavor_pol.501"
		add_legitimacy = -20
		add_prestige = 15
	}
	
	
}

country_event = { #hungary has no male and poland has no piast monarch either female or male.
	id = flavor_pol.503
	title = "flavor_pol.title.30236"
	desc = "flavor_pol.desc.30236"
	picture = DEATH_OF_HEIR_eventPicture
	is_triggered_only = yes
	
	immediate = {  
	}
	
	option = { #female woman
		name = "flavor_pol.30236.a"
		ai_chance = { factor = 10 }
		HUN = {
			create_union = POL
		}
		add_liberty_desire = 100
		set_country_flag = woman_great_king
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, union with Hungary (ruled by woman):flavor_pol.503"
	}
	
	option = { #no thx
		name = "flavor_pol.30236.b"
		ai_chance = { factor = 75 }
		add_legitimacy = -15
		add_prestige = 10
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, no union with Hungary (as it was ruled by woman):flavor_pol.503"
	}
	
	option = { #go with bohemia
		name = flavor_pol.30234.a
		ai_chance = { factor = 15 }
		BOH = { create_union = POL }
		add_liberty_desire = 75
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, no union with Hungary (as it was ruled by woman):flavor_pol.503"
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, union with Bohemia:flavor_pol.503"
	}
}


#Fired from insta PU. Almost the same as previous event (501) with the difference that it adds possibility for Bohemian PU.
country_event = { 
	id = flavor_pol.504
	title = "flavor_pol.30234.title"
	desc = {
		trigger = {
			HUN = { has_ruler = "Louis the Great" } 
		}
		desc = "flavor_pol.3022b.desca"
	}
	desc = {
		trigger = {
			NOT = { HUN = { has_ruler = "Louis the Great" } }
			NOT = { 
				HUN = { has_regency = yes }  
				HUN = { has_consort_regency = yes } 
				HUN = { is_female = yes }
			}
		}
		desc = "flavor_pol.30222b.descb"
	}
	desc = {
		trigger = {
			NOT = { HUN = { has_ruler = "Louis the Great" } }
			HUN = { 
				has_heir = yes 
				has_female_heir = no 
				OR = { 
					has_regency = yes 
					has_consort_regency = yes 
				} 
			}
		}
		desc = "flavor_pol.302222b.desc"
	}
	
	desc = {
		trigger = {
			NOT = { HUN =  { has_ruler = "Louis the Great" } }
			OR = {
				HUN = { 
					has_heir = yes 
					has_female_heir = yes 
					OR = { 
						has_regency = yes 
						has_consort_regency = yes 
					} 
				}
				AND = {
					is_female = yes
					has_regency = no
					has_consort_regency = no
				}
			}
		}
		desc = "flavor_pol.3022222b.desc"
	}
	picture = POLICY_eventPicture
	is_triggered_only = yes 
	fire_only_once = yes
	major = yes
	trigger = { 
		tag = POL
		junior_union_with = HUN 
		NOT = { is_year = 1390 }
		AND = {
			NOT = { has_country_flag = pol_louis_great_king }
			NOT = { has_country_flag = pol_louis_son_great_king }
			NOT = { has_country_flag = woman_great_king }
		}
	}
	
	immediate = {
		clr_country_flag = pol_louis_great_heir
		
	}
	
	option = { #normal PU when louis alive
		trigger = { HUN = { has_ruler = "Louis the Great" } }
		name = "flavor_pol.30234.a"
		#HUN = { create_union = POL }
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Hungary (with Louis):flavor_pol.504"	
		set_country_flag = pol_louis_great_king
		add_liberty_desire = 40
	}
	
	option = { #make new male ruler PU
		name = "flavor_pol.3022c.a"
		ai_chance = { 
			factor = 10
			modifier = { 
				factor = 1.5
				HUN = { legitimacy = 60 }
			}
			modifier = { 
				factor = 2
				HUN = { legitimacy = 85 }
			}	
		}
		trigger = { 
			NOT = { HUN =  { has_ruler = "Louis the Great" } }
			NOT = { 
				HUN = { has_regency = yes }  
				HUN = { has_consort_regency = yes } 
				is_female = yes
			}
		}
			
		HUN = { create_union = POL }
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Hungary (without Louis):flavor_pol.504"	
		add_liberty_desire = 75
		set_country_flag = pol_louis_son_great_king
	}
	
	option = { #make male heir PU
		name = "flavor_pol.3022c.b"
		ai_chance = { 
			factor = 10
			modifier = { 
				factor = 1.5
				HUN = { heir_claim = 60 }
			}
			modifier = { 
				factor = 2
				HUN = { heir_claim = 85 }
			}
		}
		trigger = {	
			NOT = { HUN =  { has_ruler = "Louis the Great" } }
			HUN = { 
				has_heir = yes 
				has_female_heir = no 
				OR = { 
					has_regency = yes 
					has_consort_regency = yes 
				} 
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Hungary (without Louis):flavor_pol.504"	
		HUN = { create_union = POL }
		add_liberty_desire = 75
		set_country_flag = pol_louis_son_great_king
	}
	
	
	option = { #politely decline
		name = "flavor_pol.30234.c"
		ai_chance = { factor = 90 }
		trigger = {
			NOT = { HUN =  { has_ruler = "Louis the Great" } }
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, declined PU under Hungary (without Louis):flavor_pol.504"
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, local noble became ruler:flavor_pol.504"
		break_union = HUN
		define_ruler = {
			claim = 20
			female = no
			culture = polish
		}
	}
	
	option = { #Go with woman
		name = "flavor_pol.30236.a"
		ai_chance = { factor = 10 }
		trigger = {
			NOT = { HUN =  { has_ruler = "Louis the Great" } }
			OR = {
				HUN = { 
					has_heir = yes 
					has_female_heir = yes 
					OR = { 
						has_regency = yes 
						has_consort_regency = yes 
					} 
				}
				AND = {
					is_female = yes
					has_regency = no
					has_consort_regency = no
				}
			}
		}
		HUN = {
			create_union = POL
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Hungary (ruler is a woman):flavor_pol.504"
		add_liberty_desire = 100
		set_country_flag = woman_great_king
	}
	
	option = { #bohemia
		name = "flavor_pol.30236.c"
		trigger = {
		}
		ai_chance = { factor = 10 }
		BOH = {
			create_union = POL
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, PU under Bohemia:flavor_pol.504"
		add_liberty_desire = 75
	}
}



#Mazovia Independence
country_event = { 
	id = flavor_pol.505
	title = "flavor_pol.title.505"
	desc = "flavor_pol.desc.505"
	picture = DEATH_OF_HEIR_eventPicture
	is_triggered_only = yes #triggered from kazimiers death from on actions
	fire_only_once = yes
	hidden = yes
	trigger = {
		tag = POL
	}
	immediate = {  
		if = {
			limit = {
				POL = { is_lesser_in_union = yes }
			}
			country_event = { id = flavor_pol.506 days = 1 }
		}
		else = {
			country_event = { id = flavor_pol.507  days = 1 }
		}
	}
	
	option = {
		name = flavor_pol.505.a
	}
}

country_event = { 
	id = flavor_pol.506
	title = "flavor_pol.title.506"
	desc = "flavor_pol.desc.506"
	picture = DEATH_OF_HEIR_eventPicture
	is_triggered_only = yes
	trigger = {
		tag = POL
	}
	
	
	option = { #fully accept everything
		name = "option.flavor_pol.506.a"
		custom_tooltip = custom.option.flavor_pol.506.a
		ai_chance = { factor = 10 }
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Mazovia became independent:flavor_pol.506"
		MAZ = { 
			grant_independence = yes 
		}
		if = { 
			limit = {
				257 = { #Plock
					owned_by = POL
				}
			}
			257 = { cede_province = MAZ }
			log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Plock ceded to Mazovia:flavor_pol.506"
		}
		if = { 
			limit = {
				2506 = { #Wizna
					owned_by = POL
				}
			}
			2506 = { cede_province = MAZ }
			log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Wizna ceded to Mazovia:flavor_pol.506"
		}
		if = { 
			limit = {
				2815 = { #Dobrzyn
					owned_by = POL
				}
			}
			2815 = { cede_province = MAZ }
			log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Dobrzyn ceded to Mazovia:flavor_pol.506"
		}
		hidden_effect = {
			if = { 
				limit = { 
					HUN = { 
						ai = yes
						overlord_of = POL
					}
				}
				HUN = {
					create_guarantee = MAZ
				}
			}
			MAZ = {
				add_trust = { 
					who = POL 
					value = 40
				}
			}
		}
	}
	
	option = { #not cede provinces
		name = "option.flavor_pol.506.b"
		ai_chance = { factor = 10 }
		custom_tooltip = custom.option.flavor_pol.506.b
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Mazovia became independent, no provinces ceded:flavor_pol.506"
		MAZ = { 
			grant_independence = yes 
			set_country_flag = pol_meh_rights
		}
		hidden_effect = {
			if = { 
				limit = { 
					HUN = { ai = yes }
				}
				HUN = {
					create_guarantee = MAZ
				}
			}
		}
	}
}

country_event = { 
	id = flavor_pol.507
	title = "flavor_pol.title.507"
	desc = "flavor_pol.desc.507"
	picture = DEATH_OF_HEIR_eventPicture
	is_triggered_only = yes
	trigger = {
		tag = POL
	}
	immediate = {  
	}
	
	option = { #fully accept everything
		name = "option.flavor_pol.507.a"
		ai_chance = { factor = 70 }
		custom_tooltip = custom.option.flavor_pol.506.a
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Mazovia became independent:flavor_pol.507"
		MAZ = { 
			grant_independence = yes 
		}
		if = {
			limit = { ai = yes }
			POL = {
				create_guarantee = MAZ
			}
		}
		MAZ = {
			add_trust = { 
				who = POL 
				value = 40
			}
		}
		add_truce_with = MAZ
	}
	
	option = { #Mazovia caves
		name = "option.flavor_pol.507.b"
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Mazovia did not became independent:flavor_pol.507"
		custom_tooltip = custom.option.flavor_pol.507.b
		ai_chance = { factor = 100 }
		trigger = {
			legitimacy = 75
		}
	}
	
	option = { #Mazovia rebels
		name = "option.flavor_pol.507.c"
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, Mazovia did not became independent:flavor_pol.507"
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Kazimierz III, war started over Mazovian vassalage:flavor_pol.507"
		ai_chance = { factor = 30 }
		trigger = {
			NOT = { legitimacy = 75 }
		}
		MAZ = {
			add_trust = { 
				who = POL 
				value = -40
			}
			set_country_flag = pol_dennied_rights
			add_opinion = {
				who = POL
				modifier = dishonoured_agreement
			}
		}
		declare_war_with_cb = {
			who = MAZ
			casus_belli = cb_vassalize_mission
		}
	}
}


# Louis or whoever got a woman
country_event = {
	id = flavor_pol.302
	title = "flavor_pol.302.title"
	desc = "flavor_pol.302.desc"
	picture = JADWIGA_OATH_eventPicture
	
	major = yes
	fire_only_once = yes
	is_triggered_only = yes
	
	trigger = {
		tag = POL
		junior_union_with = HUN
		OR = {
			has_country_flag = pol_louis_great_king
			has_country_flag = pol_louis_son_great_king
			has_country_flag = woman_great_king
		}
		HUN = {
			is_lesser_in_union = no
			OR = {
				AND = {
					is_female = yes
                    has_consort_regency = no
				}
                AND = {
					is_female = yes
					has_regency = no
				}
				AND = {
					has_consort_regency = yes
					has_female_heir = yes
                    has_heir = yes
				}
				AND = {
					has_regency = yes
					has_female_heir = yes
                    has_heir = yes
				}
			}
		}
	}

	immediate = {
		
	}
	
	option = { # Jadwiga
		name = "flavor_pol.302.d"
		ai_chance = { factor = 90 }
		trigger = {
			has_country_flag = pol_louis_great_king
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Jadwiga became a ruler of Poland:flavor_pol.302"
		if = {
			limit = {
				junior_union_with = HUN
			}
			hidden_effect = {
				break_union = HUN
			}
		}
		define_ruler = {
			name = "Jadwiga"
			dynasty = "d'Anjou"
			claim = 20
			adm = 5
			dip = 5
			mil = 4
			female = yes
		}
		add_ruler_personality = generous_personality
		#in exchange for nobles support for woman taking a throne, they were granted tax privilege
		if = {
			limit = { #if they are already at level 4 of tax exemption, increase tax exemption only once and service exemption instead
				Privilege_HasGreater = { Privilege=NOTaxE Lvl=3 } 
			}
			Privilege_NOTaxERaise = yes
			log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
			Privilege_NOServiceERaise = yes
			log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Service Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
		}
		else = {
			Privilege_NOTaxERaise = yes
			log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
			Privilege_NOTaxERaise = yes
			log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
		}
		#re-calculate rights priorities calculation
		if = {
			limit = {
				ai = yes
			}
			hidden_effect = {
				AI_ReevaluateAllGoals = yes	
				country_event = { id = POP_Census.0092 } # Refire Tax Calculation
			}
		}
	}
	option = { # Random woman
		name = "flavor_pol.302.c"
		ai_chance = { factor = 5 }
		trigger = {
			OR = {
				has_country_flag = pol_louis_son_great_king
				has_country_flag = woman_great_king
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:d'Anjou woman (not Jadwiga) became a ruler of Poland:flavor_pol.302"
		if = {
			limit = {
				junior_union_with = HUN
			}
			hidden_effect = {
				break_union = HUN
			}
		}
		define_ruler = {
			dynasty = "d'Anjou"
			claim = 20
			female = yes
		}
		#in exchange for nobles support for woman taking a throne, they were granted tax privilege
		if = {
			limit = { #if they are already at level 4 of tax exemption, increase tax exemption only once and service exemption instead
				Privilege_HasGreater = { Privilege=NOTaxE Lvl=3 } 
			}
				Privilege_NOTaxERaise = yes
				log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
				Privilege_NOServiceERaise = yes
				log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Service Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"	
			else = {
				Privilege_NOTaxERaise = yes
				log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
				Privilege_NOTaxERaise = yes
				log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
			}
		}
		#re-calculate rights priorities calculation
		if = {
			limit = {
				ai = yes
			}
			hidden_effect = {
				AI_ReevaluateAllGoals = yes	
				country_event = { id = POP_Census.0092 } # Refire Tax Calculation
			}
		}
	}
	
	option = { # stay in the pu
		name = "flavor_pol.302.f"
		ai_chance = { 
			factor = 5
			modifier = {
				factor = 0
				NOT = {
					HUN = {
						dynasty = "d'Anjou"
					}
				}
			}	
		}
		add_liberty_desire = -20
		log = "FE-POL:[GetYear]:[Root.GetName]:stayed in PU (d'Anjou woman had not became a ruler of Poland):flavor_pol.302"
	}
	
	after = {
		clr_country_flag = pol_louis_great_king
		clr_country_flag = pol_louis_son_great_king
		clr_country_flag = woman_great_king
	}
}

# Louis I Anjou or whoever got a son
country_event = {
	id = flavor_pol.303
	title = "flavor_pol.3023.title"
	desc = "flavor_pol.3023.desc"
	picture = NEW_HEIR_eventPicture
	
	major = yes
	fire_only_once = yes
	is_triggered_only = yes #from on_actions
	
	trigger = {
		tag = POL
		junior_union_with = HUN
		OR = {
			has_country_flag = pol_louis_great_king
			has_country_flag = pol_louis_son_great_king
			has_country_flag = woman_great_king
		}
		HUN = {
			is_lesser_in_union = no
			OR = {
				AND = {
					is_female = no
					has_consort_regency = no
				}
				AND = {
					is_female = no
					has_regency = no
				}
				AND = {
					has_consort_regency = yes
					has_female_heir = no
					has_heir = yes
				}
				AND = {
					has_regency = yes
					has_female_heir = no
					has_heir = yes
				}
			}
		}
	}
	
	immediate = {
		hidden_effect = {
			random_list = {
				80 = {
					set_country_flag = pol_jadwiga
				}
				20 = {
					set_country_flag = we_are_polish
				}
			}
			if = {
				limit = {
					has_country_flag = pol_louis_great_king
				}
				random_list = {
					50 = { 
						HUN = { set_country_flag = hun_will_fight_pu }
					}
					50 = {
					}
				}
			}
			else_if = {
				limit = {
					has_country_flag = pol_louis_son_great_king
				}
				random_list = {
					30 = {
						HUN = { set_country_flag = hun_will_fight_pu }
					}
					70 = {
					}
				}
			}
			else = {
				random_list = {
					20 = {
						HUN = { set_country_flag = hun_will_fight_pu }
					}
					80 = {
					}
				}
			}
		}
	}
	
	option = { # stay in the pu
		name = "flavor_pol.3023.a"
		ai_chance = {
			factor = 50
		}
		trigger = {
			has_country_flag = pol_louis_great_king
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Louis, PU continues:flavor_pol.303"		
		add_liberty_desire = -50
	}
	option = { # stay in the pu
		name = "flavor_pol.302.b"
		ai_chance = {
			factor = 35
		}
		trigger = {
			has_country_flag = pol_louis_son_great_king
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Louis, PU continues:flavor_pol.303"		
		add_liberty_desire = -20
	}
	
	option = { # stay in the pu 
		name = "flavor_pol.302.b"
		ai_chance = {
			factor = 10
		}
		trigger = {
			has_country_flag = woman_great_king
		}
		add_liberty_desire = -10
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Louis, PU continues:flavor_pol.303"	
	}
		
	option = { # polands nobility doesnt accept heir
		name = "flavor_pol.3023.e"
		trigger = {
			has_country_flag = we_are_polish
		}
		ai_chance = { 
			factor = 70
			modifier = {
				factor = 2
				NOT = {	HUN = {	dynasty = "d'Anjou"	} }
			}
		}
		custom_tooltip = custom.flavor_pol.3023.e
		POL = { break_union = HUN }
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Louis, Polish nobility doesn't accept his heir:flavor_pol.303"	
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Louis, end of personal union:flavor_pol.303"	
		hidden_effect = {
			HUN = {
				country_event = { id = flavor_hun.90 days = 5 }
			}
		}
		add_prestige = 20
	}
	
	option = { # jadwiga
		name = "flavor_pol.302.d"
		trigger = {
			has_country_flag = pol_jadwiga
		}
		ai_chance = { 
			factor = 90
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Death of Louis, Jadwiga becomes ruler:flavor_pol.303"	
		custom_tooltip = custom.flavor_pol.3023.f
		break_union = HUN
		define_ruler = {
			name = "Jadwiga"
			dynasty = "d'Anjou"
			claim = 20
			adm = 5
			dip = 5
			mil = 4
			female = yes
		}
		add_ruler_personality = generous_personality
		#in exchange for nobles support for woman taking a throne, they were granted tax privilege
		if = {
			limit = { #if they are already at level 4 of tax exemption, increase tax exemption only once and service exemption instead
				Privilege_HasGreater = { Privilege=NOTaxE Lvl=3 } 
			}
			Privilege_NOTaxERaise = yes
			log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
			Privilege_NOServiceERaise = yes
			log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Service Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
		}
		else = {
			Privilege_NOTaxERaise = yes
			log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
			Privilege_NOTaxERaise = yes
			log ="SYS-Politics:[GetYear]:[This.GetName]:granted Noble Dues Privilege to:Nobles:+:[This.GovernmentName]:::from Jadwiga succession event"
		}
		#re-calculate rights priorities calculation
		if = {
			limit = {
				ai = yes
			}
			hidden_effect = {
				AI_ReevaluateAllGoals = yes	
				country_event = { id = POP_Census.0092 } # Refire Tax Calculation
			}
		}
		
		hidden_effect = {
			if = {
				limit = {
					has_country_flag = pol_louis_great_king
					HUN = { 
						AND = {	
							dynasty = "d'Anjou"
							is_female = no
							has_regency = no
							has_consort_regency = no
						}
					}
				}
				HUN = { 
					set_country_flag = more_chance_of_cb
				}
			}
			if = {
				limit = {
					HUN = { 
						OR = {
							AND = {
								is_female = no	
								dynasty = "d'Anjou"
								has_consort_regency = no
								has_regency = no
							}
							AND = {	
								OR = {
									has_regency = yes
									has_consort_regency = yes
								}
								has_female_heir = no
								legitimacy = 75
							}
						}
					}
				}
				HUN = { country_event = { id = flavor_pol.801 days = 1 } }
			}
		}
	}
	
	after = {
		clr_country_flag = pol_louis_great_king
		clr_country_flag = pol_louis_son_great_king
		clr_country_flag = woman_great_king
		clr_country_flag = pol_jadwiga
		clr_country_flag = we_are_polish
	}
}

### Hungary male decides if he gets the cb or not
country_event = {
	id = flavor_pol.801
	title = "flavor_pol.801.t"
	desc = "flavor_pol.801.d"
	picture = COURT_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes 
	
	immediate = {
		hidden_effect = {
			remove_casus_belli = {
				target = POL
				type = cb_restore_personal_union
			}
		}
	}
	
	option = { ### hungary male will claim
		name = "flavor_pol.801.a"
		ai_chance = {
			factor = 20
			modifier = {
				factor = 3
				has_country_flag = more_chance_of_cb
			}
			modifier = {
				factor = 2
				legitimacy = 60
			}
			modifier = {
				factor = 2.5
				legitimacy = 75
			}
			modifier = {
				factor = 3
				legitimacy = 90
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:male heir makes claim to Polish throne:flavor_pol.303"
		add_casus_belli = {
			target = POL 
			type = cb_restore_personal_union
			months = 300
		}
		add_opinion = {
			who = POL
			modifier = opinion_spurned_pu
		}
		tooltip = {
			POL = {
				add_opinion = {
					who = HUN
					modifier = dishonoured_agreement
				}
			}
		}
		hidden_effect = {
			POL = { country_event = { id = flavor_pol.802 days = 1 } }
		}
	}
	
	option = { ### hungary male doesn't do a thing
		name = "flavor_pol.801.b"
		ai_chance = {
			factor = 90
			modifier = {
				factor = 0.5
				has_country_flag = more_chance_of_cb
			}
		}
		add_prestige = -10
		log = "FE-POL:[GetYear]:[Root.GetName]:male heir do not make claims to Polish throne:flavor_pol.303"
		tooltip = {
			remove_casus_belli = {
				target = POL
				type = cb_restore_personal_union
			}
		}
	}
	
	after = {
		clr_country_flag = more_chance_of_cb
	}
}

###Poland informed
country_event = {
	id = flavor_pol.802
	title = "flavor_pol.802.t"
	desc = "flavor_pol.802.d"
	picture = COURT_eventPicture
	
	is_triggered_only = yes 
	
	immediate = {
	}
	
	option = { ### hungary male will claim
		name = "flavor_pol.802.a"
		tooltip = {
			HUN = {
				add_casus_belli = {
					target = POL 
					type = cb_restore_personal_union
					months = 300
				}
			}
		}
		add_opinion = {
			who = HUN
			modifier = dishonoured_agreement
		}
	}
}

### Hungary fights por PU
country_event = {
	id = flavor_hun.90
	title = "flavor_hun.90.t"
	desc = "flavor_hun.90.d"
	picture = COURT_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes ##by POL flavor_pol.3023
	
	immediate = {
	}
	
	option = { ### hungary fights
		name = "flavor_hun.90.a"
		ai_chance = {
			factor = 1
			modifier = {
				factor = 100
				has_country_flag = hun_will_fight_pu
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:male heir declared war over claims to Polish throne:flavor_hun.90"
		declare_war_with_cb = {
			who = POL
			casus_belli = cb_restore_personal_union
		}
	}
	
	option = { ### hungary lets poland go
		name = "flavor_hun.90.b"
		ai_chance = {
			factor = 99
			modifier = {
				factor = 0
				has_country_flag = hun_will_fight_pu
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:male heir decided not to start war over claims to Polish throne:flavor_hun.90"
		log = "FE-POL:[GetYear]:[Root.GetName]:end of Polish-Hungarian union:flavor_hun.90"
		
		POL = {
			if = {
				limit = {
					junior_union_with = HUN
				}
				break_union = HUN
			}			
		}
	}
	
	after = {
		clr_country_flag = hun_will_fight_pu
	}
}

# Polish-Lithuanian Union (Pol female)
country_event = {
	id = flavor_pol.100
	title = "flavor_pol.100.title"
	desc = "flavor_pol.100.desc"
	picture = DIPLOMACY_eventPicture
	
	major = yes
	fire_only_once = yes
	
	trigger = {
	    always = no
		tag = POL
		NOT = { is_year = 1450 }
		OR = {
			AND = {
				has_regency = no
				is_female = yes
			}
			AND = {
				has_regency = yes
				has_female_heir = yes
			}
		}
		LIT = {
			exists = yes
			ai = yes
			is_lesser_in_union = no
			OR = {
				is_neighbor_of = ROOT
				any_subject_country = {
					is_neighbor_of = ROOT
				}
			}
			OR = {
				AND = {
					has_regency = no
					is_female = no
				}
				AND = {
					has_regency = yes
					has_female_heir = no
				}
			}
		}
		NOT = { war_with = LIT }
		is_lesser_in_union = no
		NOT = { exists = PLC }
	}
	
	mean_time_to_happen = {
		months = 24
		modifier = {
			factor = 0.5
			marriage_with = LIT
		}
		modifier = {
			factor = 0.25
			LIT = { religion_group = european_pagan }
		}
		modifier = {
			factor = 3.0
			LIT = { religion = orthodox }
		}
	}

	immediate = {
		if = {
			limit = {
				is_at_war = yes
			}
			every_country = {
				limit = {
					OR = {
						is_in_war = {
							attacker_leader = THIS
							participants = ROOT
						}
						is_in_war = {
							defender_leader = THIS
							participants = ROOT
						}
					}
				}
				PREV = {
					white_peace = PREV
				}
			}
		}
	}
	
	option = {		# Accept their Duke on the throne of Poland, but demand his christianisation
		name = "flavor_pol.100.a"
		ai_chance = { factor = 100 }
		trigger = {
			LIT = {
				religion_group = european_pagan
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Accepted Lithuanian Duke on the throne, but demanded his christianisation:flavor_pol.100"
		hidden_effect = {
			LIT = {
				if = {
					limit = { TRK = { ai = yes exists = yes} }
					inherit = TRK
				}
				exile_heir_as = heir_move_to_poland
				#kill_heir = {}
				exile_ruler_as = { name = ruler_move_to_poland }
				grant_independence = yes
			}
			set_ruler = ruler_move_to_poland
			#set_heir = heir_move_to_poland
			define_consort = {
				name = "Jadwiga"
				dynasty = "d'Anjou"
				culture = hungarian
				country_of_origin = HUN
				adm = 5
				dip = 5
				mil = 4
				female = yes
			}
			log = "FE-POL:[GetYear]:[Root.GetName]:Jadwiga d'Anjou set as Queen:flavor_pol.100"
			add_queen_personality = generous_personality

			if = {
				limit = {
					religion = catholic
				}
				set_ruler_religion = catholic
			}
			else_if = {
				limit = {
					religion = avignonist
				}
				set_ruler_religion = avignonist
			}

			#set_heir_religion = catholic
			create_subject = {
				subject_type = permanent_union
				subject = LIT
			}
			set_country_flag = pol_lit_union_timer	
		}
		tooltip = {
			create_union = LIT
		}

		if = {
			limit = {
				religion = catholic
				LIT = { NOT = { religion = catholic } }
			}
			#LIT = { set_country_flag = lit_become_catholic }
			LIT = { change_religion = catholic force_converted = yes }
		}
		else_if = {
			limit = {
				religion = avignonist
				LIT = { NOT = { religion = avignonist } }
			}
			LIT = { change_religion = avignonist force_converted = yes }
		}
		else_if = {
			limit = {
				religion = orthodox
				LIT = { NOT = { religion = orthodox } }
			}
			#LIT = { set_country_flag = lit_become_orthodox }
			LIT = { change_religion = orthodox force_converted = yes }
		}

		POL = {
			set_country_flag = female_pol_lit_union_female
			add_historical_friend = LIT
		}
		add_opinion = {
			who = LIT
			modifier = pol_lit_union
		}
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union
			}
			add_historical_friend = POL
		}
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = noble_rebels
				size = 2
			}
		}
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = noble_rebels
				size = 2
			}
		}
		every_known_country = {
			limit = {
				marriage_with = LIT
			}
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union_negative
			}
		}
		hidden_effect = {
			MAZ = { country_event = { id = flavor_pol.509 days = 2 } }
			if = {
				limit = {
					dynasty = "d'Anjou'"
				}
				POL = { country_event = { id = flavor_pol.512 days = 30 } } #Habsurg marriage
			}
		}
	}
	
	option = {		# Accept their King on the throne of Poland
		name = "flavor_pol.100.b" #TODO: what with Jadwiga? in option A she was set as Queen
		ai_chance = { factor = 100 }
		trigger = {
			LIT = {
				religion_group = christian
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Accepted Lithuanian Duke on the throne, he was already Christian:flavor_pol.100"
		hidden_effect = {
			LIT = {
				if = {
					limit = { TRK = { ai = yes } }
					inherit = TRK
				}
				exile_heir_as = heir_move_to_poland
				exile_ruler_as = { name = ruler_move_to_poland }
				grant_independence = yes
			}
			set_ruler = ruler_move_to_poland
			set_heir = heir_move_to_poland

			if = {
				limit = {
					religion = catholic
				}
				set_ruler_religion = catholic
				set_heir_religion = catholic
			}
			else_if = { 
				limit = {
					religion = avignonist
				}
				set_ruler_religion = avignonist
				set_heir_religion = avignonist
			}

			create_subject = { 
				subject_type = permanent_union
				subject = LIT
			}
			set_country_flag = pol_lit_union_timer
		}
		tooltip = {
			create_union = LIT
		}
		add_opinion = {
			who = LIT
			modifier = pol_lit_union
		}
		POL = {
			set_country_flag = female_pol_lit_union_female
			add_historical_friend = LIT
		}
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union
			}
			add_historical_friend = POL
		}
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = noble_rebels
				size = 2
			}
		}
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = noble_rebels
				size = 2
			}
		}
		every_known_country = {
			limit = {
				marriage_with = LIT
			}
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union_negative
			}
		}
		hidden_effect = {
			MAZ = { country_event = { id = flavor_pol.509 days = 2 } } #Mazovia vassalization
			if = {
				limit = {
					dynasty = "d'Anjou'"
				}
				POL = { country_event = { id = flavor_pol.512 days = 30 } } #Habsurg marriage
			}
		}
	}
	
	option = {		# No, let us marry a local noble instead
		name = "flavor_pol.100.c"
		ai_chance = { factor = 0 }
		Stab_Add1 = yes
		log = "FE-POL:[GetYear]:[Root.GetName]:Rejected Lithuanian Duke on the throne, married local noble:flavor_pol.100"
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union_declined
			}
		}
	}
}

# Polish-Lithuanian Union (Lit female)
country_event = {
	id = flavor_pol.101
	title = "flavor_pol.101.title"
	desc = "flavor_pol.101.desc"
	picture = DIPLOMACY_eventPicture
	
	major = yes
	fire_only_once = yes
	
	trigger = {
		tag = POL
		NOT = { is_year = 1450 }
		OR = {
			AND = {
				has_regency = no
				is_female = no
			}
			AND = {
				has_regency = yes
				has_female_heir = no
			}
		}
		LIT = {
			exists = yes
			ai = yes
			is_lesser_in_union = no
			OR = {
				is_neighbor_of = ROOT
				any_subject_country = {
					is_neighbor_of = ROOT
				}
			}
			OR = {
				AND = {
					has_regency = no
					is_female = yes
				}
				AND = {
					has_regency = yes
					has_female_heir = yes
				}
			}
		}
		NOT = { war_with = LIT }
		is_lesser_in_union = no
		NOT = { exists = PLC }
	}
	
	mean_time_to_happen = {
		months = 24
		modifier = {
			factor = 0.5
			marriage_with = LIT
		}
		modifier = {
			factor = 0.25
			LIT = { religion_group = european_pagan }
		}
		modifier = {
			factor = 3.0
			LIT = { religion = orthodox }
		}
	}
	
	option = {		# Accept the crown of Grand Duchy and demand its christianisation
		name = "flavor_pol.101.a"
		ai_chance = { factor = 100 }
		log = "FE-POL:[GetYear]:[Root.GetName]:Accepted the crown of Lithuanian Grand Duchy, but demanded its christianisation:flavor_pol.101"
		trigger = {
			LIT = {
				religion_group = european_pagan
			}
		}
		LIT = {
			if = {
				limit = { TRK = { ai = yes } }
				inherit = TRK
			}
		}
		create_subject = { 
			subject_type = permanent_union
			subject = LIT
		}

		if = {
			limit = {
				religion = catholic
				LIT = { NOT = { religion = catholic } }
			}
			#LIT = { set_country_flag = lit_become_catholic }
			LIT = { change_religion = catholic force_converted = yes }
		}
		else_if = {
			limit = {
				religion = avignonist
				LIT = { NOT = { religion = avignonist } }
			}
			LIT = { change_religion = avignonist force_converted = yes }
		}
		else_if = {
			limit = {
				religion = orthodox
				LIT = { NOT = { religion = orthodox } }
			}
			#LIT = { set_country_flag = lit_become_orthodox }
			LIT = { change_religion = orthodox force_converted = yes }
		}
		
		add_opinion = {
			who = LIT
			modifier = pol_lit_union
		}
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union
			}
			add_historical_friend = POL
		}
		add_historical_friend = LIT
		
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = noble_rebels
				size = 2
			}
		}
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = noble_rebels
				size = 2
			}
		}
		every_known_country = {
			limit = {
				marriage_with = LIT
			}
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union_negative
			}
		}
		hidden_effect = {
			MAZ = { country_event = { id = flavor_pol.509 days = 2 } }
			set_country_flag = pol_lit_union_timer
		}
	}
	
	option = {		# Accept the crown of Grand Duchy
		name = "flavor_pol.101.b"
		ai_chance = { factor = 100 }
		trigger = {
			LIT = {
				religion = catholic
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:Accepted the crown of Lithuanian Grand Duchy, have not demanded its christianisation:flavor_pol.101"
		LIT = {
			if = {
				limit = { TRK = { ai = yes } }
				inherit = TRK
			}
		}
		create_subject = { 
			subject_type = permanent_union
			subject = LIT
		}
		add_opinion = {
			who = LIT
			modifier = pol_lit_union
		}
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union
			}
			add_historical_friend = POL
		}
		add_historical_friend = LIT
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = noble_rebels
				size = 2
			}
		}
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = noble_rebels
				size = 2
			}
		}
		every_known_country = {
			limit = {
				marriage_with = LIT
			}
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union_negative
			}
		}
		hidden_effect = {
			MAZ = { country_event = { id = flavor_pol.509 days = 2 } }
			set_country_flag = pol_lit_union_timer
		}
	}
	
	option = {		# Seach for an appropriate Polish bride
		name = "flavor_pol.101.c"
		log = "FE-POL:[GetYear]:[Root.GetName]:Rejected the crown of Lithuanian Grand Duchy, married local noble:flavor_pol.101"
		ai_chance = { factor = 0 }
		Stab_Add1 = yes
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = pol_lit_union_declined
			}
		}
	}
}

#Mazovian vassalization
country_event = {
	id = flavor_pol.509
	title = "flavor_pol.509.t"
	desc = "flavor_pol.509.d"
	picture = COURT_eventPicture
	is_triggered_only = yes 
	
	trigger = {
		MAZ = { is_subject = no }
	}
		
	option = { ### Mazovia becomes loyal again
		name = "flavor_pol.509.a"
		ai_chance = {
			factor = 99
			modifier = {
				factor = 0.5
				has_country_flag = pol_dennied_rights
			}
			modifier = {
				factor = 0.3
				has_country_flag = pol_meh_rights
			}
		}
		tooltip = {
			POL = { vassalize = MAZ }
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:became loyal to Poland again:flavor_pol.509"
		hidden_effect = {
			POL = { 
				country_event = { id = flavor_pol.510 days = 1 }
			}
		}
	}
	
	option = { ### mazovia rawr
		name = "flavor_pol.509.b"
		ai_chance = {
			factor = 1
			modifier = {
				factor = 50
				has_country_flag = pol_dennied_rights
			}
			modifier = {
				factor = 30
				has_country_flag = pol_meh_rights
			}
		}
		tooltip = {
			POL = {
				add_casus_belli = {
					target = MAZ
					type = cb_vassalize_mission
					months = 60
				}
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:did not became loyal to Poland again:flavor_pol.509"
		hidden_effect = {
			POL = { 
				country_event = { id = flavor_pol.511 days = 1 }
			}
		}
	}
	
	after = {
		clr_country_flag = pol_dennied_rights
		clr_country_flag = pol_meh_rights
	}
}

#poland notification mazovia becomes a vassal
country_event = {
	id = flavor_pol.510
	title = "flavor_pol.510.t"
	desc = "flavor_pol.510.d"
	picture = COURT_eventPicture
	is_triggered_only = yes 
	
    #immediate = { #Commented out as it was granting independence to Poland
    #    hidden_effect = { grant_independence = yes }
    #}	
	
	option = { ### Mazovia becomes loyal again
		name = "flavor_pol10.a"
		POL = { vassalize = MAZ }
		add_prestige = 20
		MAZ = { 
			add_trust = {
				who = POL
				value = 50
				mutual = yes
			}
		}
	}
}

#poland notification mazovia won't become a vassal
country_event = {
	id = flavor_pol.511
	title = "flavor_pol.511.t"
	desc = "flavor_pol.511.d"
	picture = COURT_eventPicture
	is_triggered_only = yes 
	
	
	option = { ### Mazovia rawr
		name = "flavor_pol11.a"
		add_casus_belli = {
			target = MAZ
			type = cb_vassalize_mission
			months = 60
		}
	}
}

#Habsburg marriage for POL
country_event = {
	id = flavor_pol.512
	title = "flavor_pol.512.t"
	desc = "flavor_pol.512.d"
	picture = COURT_eventPicture
	
	is_triggered_only = yes 
	
	option = { ### Pay austria
		name = "flavor_po512.a"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 0.5
				NOT = { treasury = 51 }
			}
			modifier = {
				factor = 0.5
				NOT = { LIT = { treasury = 51 } }
			}
		}
		add_treasury = -50
		LIT = { add_treasury = -50 }
		tooltip = {
			HAB = { add_treasury = 100 }
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:paid compensation for Jadwiga behtrotal to Habsburgs:flavor_pol.512"
		hidden_effect = {
			HAB = { country_event = { id = flavor_pol.513 days = 1 } }
		}
	}
	
	option = { ### Don't pay
		name = "flavor_po512.b"
		ai_chance = {
			factor = 50
			modifier = {
				factor = 1.5
				NOT = { treasury = 51 }
			}
			modifier = {
				factor = 1.5
				NOT = { LIT = { treasury = 51 } }
			}
		}
		tooltip = {
			HAB = {
				add_casus_belli = {
					target = POL 
					type = cb_restore_personal_union
					months = 300
				}
				add_trust = {
					who = POL
					value = -30
				}
				add_opinion = {
					who = POL
					modifier = break_marriage
				}	
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:refused to pay compensation for Jadwiga behtrotal to Habsburgs:flavor_pol.512"
		hidden_effect = {
			HAB = { country_event = { id = flavor_pol.514 days = 1 } }
		}
	}
}
#HAB notification poland paid
country_event = {
	id = flavor_pol.513
	title = "flavor_pol.513.t"
	desc = "flavor_pol.513.d"
	picture = COURT_eventPicture
	
	
	is_triggered_only = yes 
	
	option = { 
		name = "flavor_po513.a"
		add_treasury = 100
		add_opinion = {
			who = POL
			modifier = opinion_spurned_heir
		}	
	}
}
#HAB notification poland didn't pay
country_event = {
	id = flavor_pol.514
	title = "flavor_pol.514.t"
	desc = "flavor_pol.514.d"
	picture = COURT_eventPicture
	
	is_triggered_only = yes 

	option = { 
		name = "flavor_po514.a"
		add_casus_belli = {
			target = POL 
			type = cb_restore_personal_union
			months = 300
		}
		add_opinion = {
			who = POL
			modifier = break_marriage
		}	
		add_trust = {
			who = POL
			value = -30
		}
	}
}

#Create Dynasty after death of first Gediminai ruler
country_event = {
	id = flavor_pol.305
	title = "flavor_pol.305.title"
	desc = "flavor_pol.305.desc"
	picture = NEW_HEIR_eventPicture
	is_triggered_only = yes #from on_monarch_death
	fire_only_once = yes
	
	trigger = {
		tag = POL
		dynasty = "Gediminai"
	}
		
	option = {
		name = "flavor_pol.305.a"
		ai_chance = { factor = 5 }
		set_dynasty = "Piast"
		custom_tooltip = flavor_pol.305.a.tooltip
		log = "FE-POL:[GetYear]:[Root.GetName]:changed dynasty name to Piast:flavor_pol.305"
	}
	option = {
		name = "flavor_pol.305.b"
		ai_chance = { factor = 5 }
		log = "FE-POL:[GetYear]:[Root.GetName]:kept dynasty name as Gediminai:flavor_pol.305"
	}
	option = {
		name = "flavor_pol.305.c"
		ai_chance = { factor = 90 }
		set_dynasty =  "Jagiellon" 
		custom_tooltip = flavor_pol.305.c.tooltip
		log = "FE-POL:[GetYear]:[Root.GetName]:changed dynasty name to Jagiellon:flavor_pol.305"
	}
}

#Polish-Lithuanian claims for Podlasia
country_event = {
	id = flavor_pol.313
	title = "flavor_pol.313.title"
	desc = "flavor_pol.313.desc"
	picture = DIPLOMACY_eventPicture
	fire_only_once = yes
	trigger = {
		tag = POL
		is_at_war = no
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
			}
		}
		#is_year = 1440
		LIT = {
			OR = {
				owns_or_vassal_of = 271  #Bialystok
				owns_or_vassal_of = 3759 #Drohiczyn
				owns_or_vassal_of = 3763 #Bielskas
			}
		}
		OR = { #event is about Mazowsze nobles interests
			owns_or_vassal_of = 4026  #Ciechanow
			owns_or_vassal_of = 2816 #Liw
		}
	}
	mean_time_to_happen = {
		years = 10
	}
	option = {
		name = "flavor_pol.313.a"
		trigger = {
			NOT = {
				LIT = {
					has_opinion = {
						who = ROOT
						value = 150
					}
				}
			}
		}

		if = {
			limit = {
				LIT = {
					owns_or_vassal_of = 271
				}
			}
			log = "FE-POL:[GetYear]:[271.Owner.GetName]:ceded Bialystok to Poland:flavor_pol.313"
			271 = { #Bialystok
				cede_province = ROOT
				add_core = ROOT
				remove_core = LIT
				spawn_rebels = {
					type = warlord_rebels
					size = 2
				}
			}
		}
		if = {
			limit = {
				LIT = {
					owns_or_vassal_of = 3759
				}
			}
			log = "FE-POL:[GetYear]:[3759.Owner.GetName]:ceded Drohiczyn to Poland:flavor_pol.313"
			3759 = { #Drohiczyn
				cede_province = ROOT
				add_core = ROOT
				remove_core = LIT
				spawn_rebels = {
					type = warlord_rebels
					size = 2
				}
			}
		}
		if = {
			limit = {
				LIT = {
					owns_or_vassal_of = 3763
				}
			}
			log = "FE-POL:[GetYear]:[3763.Owner.GetName]:ceded Bielskas to Poland:flavor_pol.313"
			3763 = { #Bielskas
				cede_province = ROOT
				add_core = ROOT
				remove_core = LIT
				spawn_rebels = {
					type = warlord_rebels
					size = 2
				}
			}
		}
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = ceded_podlasia
			}
		}
		Pol_ChangeRelationsStateTooltip = { NO=yes type=value val=5 }

		hidden_effect = {
			every_province = {
				limit = { 
					area = mazovia_area 
					owner = {
						OR = {
							tag = ROOT
							vassal_of = ROOT
						}
					}
				}
				Public_ChangePowerbrokerLoyaltyTooltip = { Powerbroker=NO Amount=10 }
			}
		}
		custom_tooltip = mazovia_NO_loy_plus_10_tt
	}
	option = {
		name = "flavor_pol.313.b"
		trigger = {
			LIT = {
				has_opinion = {
					who = ROOT
					value = 150
				}
			}
		}
		if = {
			limit = {
				LIT = {
					owns_or_vassal_of = 271
				}
			}
			log = "FE-POL:[GetYear]:[271.Owner.GetName]:ceded Bialystok to Poland:flavor_pol.313"
			271 = { #Bialystok
				cede_province = ROOT
				add_core = ROOT
				remove_core = LIT
				spawn_rebels = {
					type = warlord_rebels
					size = 1
				}
			}
		}
		if = {
			limit = {
				LIT = {
					owns_or_vassal_of = 3759
				}
			}
			log = "FE-POL:[GetYear]:[3759.Owner.GetName]:ceded Drohiczyn to Poland:flavor_pol.313"
			3759 = { #Drohiczyn
				cede_province = ROOT
				add_core = ROOT
				remove_core = LIT
				spawn_rebels = {
					type = warlord_rebels
					size = 1
				}
			}
		}
		if = {
			limit = {
				LIT = {
					owns_or_vassal_of = 3763
				}
			}
			log = "FE-POL:[GetYear]:[3763.Owner.GetName]:ceded Bielskas to Poland:flavor_pol.313"
			3763 = { #Bielskas
				cede_province = ROOT
				add_core = ROOT
				remove_core = LIT
				spawn_rebels = {
					type = warlord_rebels
					size = 1
				}
			}
		}
		LIT = {
			add_opinion = {
				who = ROOT
				modifier = ceded_podlasia
			}
		}
		Pol_ChangeRelationsStateTooltip = { NO=yes type=value val=5 }
		hidden_effect = {
			every_province = {
				limit = { 
					area = mazovia_area 
					owner = {
						OR = {
							tag = ROOT
							vassal_of = ROOT
						}
					}
				}
				Public_ChangePowerbrokerLoyaltyTooltip = { Powerbroker=NO Amount=10 }
			}
		}
		custom_tooltip = mazovia_NO_loy_plus_10_tt
	}
	option = {
		name = "flavor_pol.313.c"
		add_prestige = -5
		log = "FE-POL:[GetYear]:[Root.GetName]:have not pushed Lithuania for ceding Podolia:flavor_pol.313"
		Pol_ChangeRelationsStateTooltip = { NO=yes type=value val=-5 }
		hidden_effect = {
			every_province = {
				limit = { 
					area = mazovia_area 
					owner = {
						OR = {
							tag = ROOT
							vassal_of = ROOT
						}
					}
				}
				Public_ChangePowerbrokerLoyaltyTooltip = { Powerbroker=NO Amount=-10 }
			}
		}
		custom_tooltip = mazovia_NO_loy_minus_10_tt
	}
}
#Territorial disputes between Poland and Lithuania
country_event = {
	id = flavor_pol.306
	title = "flavor_pol.306.title"
	desc = "flavor_pol.306.desc"
	picture = DIPLOMACY_eventPicture
	fire_only_once = yes
	trigger = {
		tag = POL
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
			}		}
		OR = {
			claim = LIT
			core_claim = LIT
			LIT = {
				claim = ROOT
			}
			LIT = {
				core_claim = ROOT
			}
			GVO = {
				is_subject_of = LIT
				exists = yes
				ai = yes
			}
		}
	}
	mean_time_to_happen = {
		months = 12
	}
	option = {
		name = "flavor_pol.306.a"
		ai_chance = {
			factor = 100
		}

		if = {
			limit = {
				GVO = {
					is_subject_of = LIT
					exists = yes
					ai = yes
				}
			}
			log = "FE-POL:[GetYear]:[Root.GetName]:removed cores and claims from Lithuania provinces:flavor_pol.306"
			log = "FE-POL:[GetYear]:[Root.GetName]:Lithuania removed cores and claims from  Polish provinces:flavor_pol.306"
			log = "FE-POL:[GetYear]:[Root.GetName]:inherited Halych-Volhyna while settling border dispute with Lithunia:flavor_pol.306"
			POL = {
				inherit = GVO
			}
		}
		LIT = {
			custom_tooltip = flavor_pol.306.tooltip.a
			hidden_effect = {
				every_owned_province = {
					limit = {
						OR = {
							is_claim = POL
							is_core = POL
						}
					}
					remove_claim = POL
					remove_core = POL
				}
			}
		}
		POL = {
			custom_tooltip = flavor_pol.306.tooltip.b
			hidden_effect = {
				every_owned_province = {
					remove_claim = LIT
					remove_core = LIT
				}
			}
		}
		2535 = { #Cholm
			if = {
				limit = {
					OR = {
						owned_by = LIT
						owner = {
							is_subject_of = LIT
						}
					}
					any_neighbor_province = {
						owned_by = POL
					}
				}
				log = "FE-POL:[GetYear]:[Root.GetName]:inherited Cholm while settling border dispute with Lithunia:flavor_pol.306"
				cede_province = POL
				add_core = POL
				remove_core = LIT
			}
		}
		1281 = { #Ratne
			if = {
				limit = {
					OR = {
						owned_by = LIT
						owner = {
							is_subject_of = LIT
						}
					}
					any_neighbor_province = {
						owned_by = POL
					}
				}
				log = "FE-POL:[GetYear]:[Root.GetName]:inherited Ratne while settling border dispute with Lithunia:flavor_pol.306"
				cede_province = POL
				add_core = POL
				remove_core = LIT
			}
		}
		2507 = { #Belz
			if = {
				limit = {
					OR = {
						owned_by = LIT
						owner = {
							is_subject_of = LIT
						}
					}
					any_neighbor_province = {
						owned_by = POL
					}
				}
				if = {
					limit = {
						MAZ = {
							vassal_of = POL
						}
					}
					log = "FE-POL:[GetYear]:[MAZ.GetName]:inherited Belz while settling border dispute with Lithunia:flavor_pol.306"
					cede_province = MAZ
					add_core = MAZ
					remove_core = LIT
				}
				else = {
					log = "FE-POL:[GetYear]:[Root.GetName]:inherited Belz while settling border dispute with Lithunia:flavor_pol.306"
					cede_province = POL
					add_core = POL
					remove_core = LIT
				}
			}
		}
	}
	option = {
		name = "flavor_pol.306.b"
		ai_chance = {
			factor = 0
		}		
		log = "FE-POL:[GetYear]:[Root.GetName]:decided not to settle border disputes with Lithuania, maintained status quo:flavor_pol.306"
	}
}
country_event = {
	id = flavor_pol.600 #Union of Krewo
	title = "flavor_pol.600.title"
	desc = "flavor_pol.600.desc"
	picture = DIPLOMACY_eventPicture
	major = yes
	fire_only_once = yes
	trigger = {
		tag = POL
		is_year = 1380
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
			}		}
		NOT = {	exists = PLC }
		NOT = {	has_country_flag = 1_union_krewo }
	}
	mean_time_to_happen = {
		years = 1
	}
	option = {
		name = "flavor_pol.600.a"
		log = "FE-POL:[GetYear]:[Root.GetName]:signed union of Krewo:flavor_pol.600"
		ai_chance = {
			factor = 100
		}
		set_country_flag = 1_union_krewo
		tooltip = {
			custom_tooltip = flavor_pol.union_sign.1
		}
		add_prestige = 10
		add_adm_power = 50
		add_dip_power = 50
		add_legitimacy = 15
		add_absolutism = -10
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = 10 }
		hidden_effect = {
			set_variable = {
				which = bow_to_nobles
				value = 1
			}
			if = {
				limit = {
					monarchy_or_harem_gov = yes
					NOT = {	absolutism = 70 }
				}
				Pol_ChangeGovMonarchy = { Succession=1 Assembly=2 } 
				add_government_reform = Pol_Nobility3
			}
		}
	}
}
country_event = {
	id = flavor_pol.601 #Union of Horodlo
	title = "flavor_pol.601.title"
	desc = "flavor_pol.601.desc"
	picture = DIPLOMACY_eventPicture
	major = yes
	fire_only_once = yes
	is_triggered_only = yes		#On_new_monarch on_action
	trigger = {
		tag = POL
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
			}
		}
		has_country_flag = 1_union_krewo
		NOT = {	has_global_flag = 1530_start_date }
		NOT = {	exists = PLC }
		had_country_flag = {
			flag = pol_lit_union_timer
			days = 9125		#25 years
		}
	}

	option = {
		name = "flavor_pol.601.a"
		ai_chance = {
			factor = 90
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:signed union of Horodlo:flavor_pol.601"
		add_legitimacy = -10
		add_dip_power = -100
		add_absolutism = 10
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = -15 }
		random_owned_province = {
			limit = {
				is_capital = no
				culture = polish
			}
			spawn_rebels = {
				type = warlord_rebels
				size = 1
			}
		}
		random_owned_province = {
			limit = {
				is_capital = no
				culture = polish
				NOT = { has_siege = yes }
			}
			spawn_rebels = {
				type = warlord_rebels
				size = 1
			}
		}
		set_country_flag = 2_union_horodlo
		tooltip = {
			custom_tooltip = flavor_pol.union_sign.2
		}
	}
	option = {
		name = "flavor_pol.601.b"
		ai_chance = {
			factor = 10
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:refused union of Horodlo:flavor_pol.601"
		add_absolutism = -10
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = 15 }
		hidden_effect = {
			change_variable = {
				which = bow_to_nobles
				value = 2
			}
		}
		add_legitimacy = 15
	}
}
country_event = {
	id = flavor_pol.602 #Union of Grodno
	title = "flavor_pol.602.title"
	desc = "flavor_pol.602.desc"
	picture = DIPLOMACY_eventPicture
	major = yes
	fire_only_once = yes
	is_triggered_only = yes #On_new_monarch on_action
	trigger = {
		tag = POL
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
			}		
		}
		has_country_flag = 2_union_horodlo
		NOT = {	has_global_flag = 1530_start_date }
		NOT = {	exists = PLC }
		had_country_flag = {
			flag = pol_lit_union_timer
			days = 21900	#60 years
		}
	}

	option = {
		name = "flavor_pol.602.a"
		ai_chance = {
			factor = 90
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:signed union of Grodno:flavor_pol.602"
		set_country_flag = 3_union_grodno
		tooltip = {
			custom_tooltip = flavor_pol.union_sign.3
		}
		add_dip_power = -100
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = -15 }
		LIT = {
			#every_owned_province = {
			#	add_unrest = 2
			#}
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = -15 }
		}
		LIT = {
			random_owned_province = {
				limit = {
					is_capital = no
					religion = orthodox
				}
				spawn_rebels = {
					type = warlord_rebels 	#TODO: were Orthodox rebels, but they don't exist yet
					size = 1
				}
			}
			random_owned_province = {
				limit = {
					is_capital = no
					religion = orthodox
				}
				spawn_rebels = {
					type = warlord_rebels
					size = 1
				}
			}
			random_owned_province = {
				limit = {
					is_capital = no
					religion = orthodox
				}
				spawn_rebels = {
					type = warlord_rebels
					size = 1
				}
			}
		}
	}
	option = {
		name = "flavor_pol.602.b"
		ai_chance = {
			factor = 10
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:refused union of Grodno:flavor_pol.602"
		hidden_effect = {
			change_variable = {
				which = bow_to_nobles
				value = 1
			}
		}
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = 15 }
		add_legitimacy = 10
	}
}
country_event = {
	id = flavor_pol.603 #Union of Krakow and Vilna
	title = "flavor_pol.603.title"
	desc = "flavor_pol.603.desc"
	picture = DIPLOMACY_eventPicture
	major = yes
	fire_only_once = yes
	is_triggered_only = yes	#On_new_monarch on_action
	trigger = {
		tag = POL
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
			}		
		}
		has_country_flag = 3_union_grodno
		NOT = {
			has_global_flag = 1530_start_date
		}
		NOT = {
			exists = PLC
		}
		had_country_flag = {
			flag = pol_lit_union_timer
			days = 36500	#100 years
		}
	}

	option = {
		name = "flavor_pol.603.a"
		ai_chance = {
			factor = 80
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:signed union of Krakow and Vilna:flavor_pol.603"
		set_country_flag = 4_union_krakow
		tooltip = {
			custom_tooltip = flavor_pol.union_sign.4
		}
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = -10 }
		add_legitimacy = 10
		add_adm_power = -100
	}
	option = {
		name = "flavor_pol.603.b"
		ai_chance = {
			factor = 20
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:refused union of Krakow and Vilna:flavor_pol.603"
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = 10 }
		add_prestige = -10
		hidden_effect = {
			change_variable = {
				which = bow_to_nobles
				value = 1
			}
		}
	}
}
country_event = {
	id = flavor_pol.604 #Union of Lublin
	title = "flavor_pol.604.title"
	desc = "flavor_pol.604.desc"
	picture = UNION_LUBLIN_eventPicture
	major = yes
	fire_only_once = yes
	is_triggered_only = yes		#On_new_monarch on_action
	trigger = {
		tag = POL
		is_at_war = no
		AND = {
			OR = {
				is_subject = no
				is_subject_of_type = tributary_state
				is_subject_of_type = close_tributary_state
			}
		}
		has_country_flag = 4_union_krakow
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
			}
		}
		NOT = {	exists = PLC }
		had_country_flag = {
			flag = pol_lit_union_timer
			days = 38325  #105 years
		}
	}

	immediate = {
		hidden_effect = {
			clr_country_flag = pol_lit_union_timer
		}
	}
	option = {
		name = "flavor_pol.604.a"
		ai_chance = {
			factor = 90
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:signed union of Lublin:flavor_pol.604"
		custom_tooltip = flavor_pol.union_sign.5
		set_country_flag = 5_union_lublin
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = -10 }
	}
	option = {
		name = "flavor_pol.604.b"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				has_global_flag = 1530_start_date
			}
		}
		log = "FE-POL:[GetYear]:[Root.GetName]:refused union of Lublin:flavor_pol.604"
		add_legitimacy = -50
		add_absolutism = -10
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = 10 }
		hidden_effect = {
			set_variable = {
				which = bow_to_nobles
				value = 2
			}
			if = {
				limit = {
					monarchy_or_harem_gov = yes
					NOT = {
						absolutism = 70
					}
				}
				Pol_ChangeGovMonarchy = { Succession=1 Assembly=3 } 
				add_government_reform = Pol_Nobility3
			}
		}
	}
}
country_event = {
	id = flavor_pol.610 #Elective Monarchy!
	title = "flavor_pol.610.title"
	desc = "flavor_pol.610.desc"
	picture = DIPLOMACY_eventPicture
	major = yes
	fire_only_once = yes
	trigger = {
		OR = {
			tag = POL
			tag = PLC
		}
		monarchy_or_harem_gov = yes
		check_variable = {
			which = bow_to_nobles
			value = 1
		}
		OR = {
			has_heir = no
			check_variable = {
				which = bow_to_nobles
				value = 3
			}
		}
	}
	mean_time_to_happen = {
		years = 30
		modifier = {
			factor = 0.8
			check_variable = {
				which = bow_to_nobles
				value = 2
			}
		}
		modifier = {
			factor = 0.8
			check_variable = {
				which = bow_to_nobles
				value = 3
			}
		}
		modifier = {
			factor = 0.8
			check_variable = {
				which = bow_to_nobles
				value = 4
			}
		}
		modifier = {
			factor = 0.8
			check_variable = {
				which = bow_to_nobles
				value = 5
			}
		}
	}
	option = {
		name = "flavor_pol.610.a"
		log = "FE-POL:[GetYear]:[Root.GetName]:moved to elective monarchy:flavor_pol.610"
		Pol_ChangeGovMonarchy = { Succession=4 Assembly=2 } 
		add_government_reform = Pol_Nobility1
		set_variable = {
			which = bow_to_nobles
			value = 2
		}
	}
}
country_event = {
	id = flavor_pol.17
	title = flavor_pol.17.t
	desc = flavor_pol.17.d
	picture = LIBERUM_VETO_eventPicture
	fire_only_once = yes
	trigger = {
		OR = {
			AND = {
				tag = POL
				NOT = {	exists = PLC }
			}
			tag = PLC
		}
		historical_rival_with = TEU
		TEU = {	is_subject_of = ROOT }
	}
	mean_time_to_happen = {
		months = 1
	}
	option = {
		name = flavor_pol.17.a
		log = "FE-POL:[GetYear]:[Root.GetName]:ended historical rivalry with Teutonic Order:flavor_pol.17"
		add_prestige = 10
		remove_historical_rival = TEU
		TEU = {
			remove_historical_rival = ROOT
		}
	}
}

##########################
#### TEUTONIC EVENTS #####
##########################
#Ported from DeI Ludicrum submod by Piterdaw
## SUPPORT FOR TEUTONS ##

# country_event = {
# 	id = flavor_pol.719
# 	title = "flavor_pol.719.title"
# 	desc = "flavor_pol.719.desc"
# 	picture = SIEGE_eventPicture
   
#     trigger = { 
# 		OR = {
# 		culture_group = low_germanic
# 		culture_group = high_germanic
# 		is_emperor = yes
# 		}
# 		NOT = { tag = TEU }
# 		NOT = { tag = LVO }
# 		NOT = { is_year = 1500 }
# 		NOT = { government = republic }
# 		NOT = { has_ruler_flag = support_for_teutons }
# 		exists = TEU
# 		TEU = {
# 		    is_subject = no
# 			NOT = { has_country_flag = broken_by_polish }
# 		}	
# 	}

#     mean_time_to_happen = { years = 5 }

#     immediate = {
#         set_ruler_flag = support_for_teutons
# 	}	

# 	option = {
# 	    ai_chance = {
# 			factor = 50
# 			modifier = {
# 				factor = 1.2
# 				has_opinion = { who = TEU value = 50 }
# 			}
# 			modifier = {
# 				factor = 1.5
# 				has_opinion = { who = TEU value = 100 }
# 			}
# 			modifier = {
# 				factor = 1.5
# 				has_opinion = { who = TEU value = 200 }
# 			}
# 			modifier = {
# 				factor = 1.2
# 				government = theocracy
# 			}
# 		}
# 		name = "flavor_pol.719.a"
# 		add_piety = 0.05
# 		add_prestige = 5
# 		add_treasury = -50
# 		TEU = {
# 		    add_treasury = 50
# 		}
#         TEU = {
#             add_opinion = {
# 				who = ROOT
# 				modifier = supported_baltic_crusaders
# 			}
# 		}	
# 	}
# 	option = {
# 	    ai_chance = { factor = 50 }
# 		name = "flavor_pol.719.b"
# 		add_piety = -0.05
# 		add_prestige = -5
# 		TEU = {
#             add_opinion = {
# 				who = ROOT
# 				modifier = refused_to_support_baltic_crusaders
# 			}
# 		}
# 	}
# }

# ## SUPPORT FOR TEUTONS - WAR ##

# country_event = {
# 	id = flavor_pol.720
# 	title = "flavor_pol.720.title"
# 	desc = "flavor_pol.720.desc"
# 	picture = SIEGE_eventPicture
   
#     trigger = { 
# 		OR = {
# 		culture_group = low_germanic
# 		culture_group = high_germanic
# 		is_emperor = yes
# 		}
# 		NOT = { is_year = 1500 }
# 		NOT = { government = republic }
# 		NOT = { tag = TEU }
# 		NOT = { tag = LVO }
# 		NOT = { has_ruler_flag = support_for_teutons_war }
# 		exists = TEU
# 		TEU = {
# 		    is_subject = no
# 			is_at_war = yes
# 			NOT = { war_with = ROOT }
# 			NOT = { has_country_flag = broken_by_polish }
# 		}	
# 	}

#     mean_time_to_happen = { days = 30 }

#     immediate = {
#         set_ruler_flag = support_for_teutons_war
# 	}	

# 	option = {
# 	    ai_chance = {
# 			factor = 40
# 			modifier = {
# 				factor = 1.2
# 				has_opinion = { who = TEU value = 50 }
# 			}
# 			modifier = {
# 				factor = 1.5
# 				has_opinion = { who = TEU value = 100 }
# 			}
# 			modifier = {
# 				factor = 1.5
# 				has_opinion = { who = TEU value = 200 }
# 			}
# 			modifier = {
# 				factor = 1.2
# 				government = theocracy
# 			}
# 		}
# 		name = "flavor_pol.720.a"
# 		add_piety = 0.05
# 		add_prestige = 5
# 		add_treasury = -20
# 		add_manpower = -1
# 		TEU = {
# 		    add_treasury = 20
# 			add_manpower = 1
# 			change_variable = { which = support_from_europe value = 1 }
# 		}
#         TEU = {
#             add_opinion = {
# 				who = ROOT
# 				modifier = supported_baltic_crusaders
# 			}
# 		}	
# 	}
# 	option = {
# 	    ai_chance = { factor = 60 }
# 		name = "flavor_pol.720.b"
# 		add_piety = -0.05
# 		add_prestige = -5
# 		TEU = {
#             add_opinion = {
# 				who = ROOT
# 				modifier = refused_to_support_baltic_crusaders
# 			}
# 		}
# 	}
# }

# ## TEUTONIC ORDER RECEIVES SUPPORT ##

# country_event = {
# 	id = flavor_pol.721
# 	title = "flavor_pol.721.title"
# 	desc = "flavor_pol.721.desc"
# 	picture = SIEGE_eventPicture
   
#     trigger = { 
#         tag = TEU
# 		NOT = { is_year = 1500 }
# 		is_subject = no
# 		is_at_war = yes
# 		NOT = { has_country_flag = broken_by_polish }
# 		NOT = { has_country_modifier = received_support_1 }
# 		NOT = { has_country_modifier = received_support_2 }
# 		NOT = { has_country_modifier = received_support_3 }
# 		NOT = { has_country_modifier = received_support_4 }
# 		NOT = { has_country_modifier = received_support_5 }
# 	}

#     mean_time_to_happen = { days = 90 }

# 	option = {
# 		name = "flavor_pol.719.a"
# 	    if = {
# 		    limit = {
# 			    check_variable = { which = support_from_europe value = 10 }
# 				NOT = {  check_variable = { which = support_from_europe value = 20 } }
# 			}	
# 			add_country_modifier = {
# 			    name = received_support_1
# 			    duration = 3650
# 			}
# 		}
#         if = {
# 		    limit = {
# 			    check_variable = { which = support_from_europe value = 20 }
# 				NOT = {  check_variable = { which = support_from_europe value = 30 } }
# 			}	
# 			add_country_modifier = {
# 			    name = received_support_2
# 			    duration = 3650
# 			}
# 		}
#         if = {
# 		    limit = {
# 			    check_variable = { which = support_from_europe value = 30 }
# 				NOT = {  check_variable = { which = support_from_europe value = 40 } }
# 			}	
# 			add_country_modifier = {
# 			    name = received_support_3
# 			    duration = 3650
# 			}
# 		}
#         if = {
# 		    limit = {
# 			    check_variable = { which = support_from_europe value = 40 }
# 				NOT = {  check_variable = { which = support_from_europe value = 50 } }
# 			}	
# 			add_country_modifier = {
# 			    name = received_support_4
# 			    duration = 3650
# 			}
# 		}
#         if = {
# 		    limit = {
# 			    check_variable = { which = support_from_europe value = 50 }
# 			}	
# 			add_country_modifier = {
# 			    name = received_support_5
# 			    duration = 3650
# 			}
# 		}
#         set_variable = { which = support_from_europe value = 0 }	
# 	}
# }	
		
## FIRST PEACE OF THORN ##
		
country_event = {			#POL  no PLC
	id = flavor_pol.722
	title = "flavor_pol.722.title"
	desc = "flavor_pol.722.desc"
	picture = SIEGE_eventPicture
	major = yes
	trigger = { 
		tag = POL
		LIT = { 
			is_subject_of = POL 
			OR = {
				is_subject_of_type = permanent_union 
				is_subject_of_type = permanent_union_limited
			}	
		}
		NOT = { exists = PLC }
		TEU = { NOT = { has_country_flag = broken_by_polish } }
		NOT = { has_country_flag = first_peace_of_thorn }
		NOT = { has_global_flag = lithuanian_civil_war	}
		war_score_against = {
			who = TEU
			value = 40
		}

	}
	fire_only_once = yes
	
	mean_time_to_happen = { months = 2 }

	immediate = {
		set_country_flag = first_peace_of_thorn
	}

	option = {
		ai_chance = { factor = 65 }
		name = "flavor_pol.722.a" #Peace with Teutons
		white_peace = TEU
			LIT = {
				add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
				}
				add_liberty_desire = -50
			}
			every_known_country = {
				limit = {
					is_subject_of = LIT
				}
				add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
				}
			}
		if = {
				limit = { 
					 TEU = { owns = 1265 } #Semigalia
				} 
				1265 = {
					cede_province = LIT
					add_core = LIT
				}
		}
		if = {
				limit = { 
					 TEU = { owns = 1280 } #Suvalkija
				} 
				1280 = {
					cede_province = LIT
					add_core = LIT
				}
		}
		if = {
				limit = { 
					 TEU = { owns = 3397 } #Upper Lithuania/Kaunas
				} 
				3397 = { 
					cede_province = LIT
					add_core = LIT
				}
		}
		TEU = { 
			add_treasury = -500
			set_country_flag = broken_by_polish
		}
		add_treasury = 500
		hidden_effect = {
		POL = {
			every_owned_province = {
				remove_claim = TEU
				remove_core = TEU
			}
		}
		if = {
			limit = {
				LIT = {
					is_subject_of = POL
					OR = {
						is_subject_of_type = permanent_union 
						is_subject_of_type = permanent_union_limited
					}
				}
			}
			LIT = {
				every_owned_province = {
					remove_claim = TEU
					remove_core = TEU
				}
			}
		}
		}
	}

	option = {
		ai_chance = { factor = 30 }
		name = "flavor_pol.722.b" #Peace with Teutons, but demand Chełmno
		white_peace = TEU
			LIT = {
				add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
				}
				add_liberty_desire = -50
			}
			every_known_country = {
				limit = {
					is_subject_of = LIT
				}
				add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
				}
			}  
		2398 = { #Chelmno
			if = {
				limit = {
					owned_by = TEU
				}
				cede_province = POL
				add_core = POL
				remove_core = TEU
			}
		}
		if = {
				limit = { 
					 TEU = { owns = 1265 } #Semigalia
				} 
				1265 = {
					cede_province = LIT
					add_core = LIT
				}
		}
		if = {
				limit = { 
					 TEU = { owns = 1280 } #Suvalkija
			    }	 
			    1280 = {
					cede_province = LIT
		            add_core = LIT
			    }
		}
		if = {
				limit = { 
					 TEU = { owns = 3397 } #Upper Lithuania/Kaunas
			    }	 
			    3397 = {
					cede_province = LIT
		            add_core = LIT
			    }
		}
		add_country_modifier = { 
		     name = diplo_faux_pas
			 duration = 3650
		}	 
		TEU = {
			set_country_flag = broken_by_polish
		}
		hidden_effect = {
		POL = {
			every_owned_province = {
				remove_claim = TEU
				remove_core = TEU
			}
		}
		}
	}
     
	option = {
	    ai_chance = { factor = 5 }
		name = "flavor_pol.722.c" #Continue fighting
		if = {
		    limit = { 
				LIT = {
					is_subject_of = POL
					OR = {
						is_subject_of_type = permanent_union 
						is_subject_of_type = permanent_union_limited
					}
				}
			 }
	        LIT = {
			    add_opinion = {
				who = ROOT
				modifier = not_peaced_with_teutons
			    }
				add_liberty_desire = 100
				white_peace = TEU
				remove_historical_friend = POL
		    }
			add_war_exhaustion = 5
			every_known_country = {
			    limit = {
				     is_subject_of = LIT
				}
                add_opinion = {
				who = ROOT
				modifier = not_peaced_with_teutons
			    }
                white_peace = TEU
			} 
            remove_historical_friend = LIT
		}
		hidden_effect = {
		every_known_country = {
			limit = {
				religion = catholic
				capital_scope = {
			        OR = {
				        superregion = germany_superregion
				        superregion = greater_austrian_circle_superregion
			        }
		        }
			}
			add_opinion = {
				who = ROOT
				modifier = not_peaced_with_teutons
			}
		}
		}
		set_country_flag = refused_peace_of_thorn
	}
}

country_event = {		#PLC version
	id = flavor_pol.7221
	title = "flavor_pol.7221.title"
	desc = "flavor_pol.7221.desc"
	picture = SIEGE_eventPicture
    major = yes
    trigger = { 
        tag = PLC
		TEU = { NOT = { has_country_flag = broken_by_polish } }
		NOT = { has_country_flag = first_peace_of_thorn }
		NOT = { has_global_flag = lithuanian_civil_war	}
		war_score_against = {
	        who = TEU
	        value = 40
        }
	}
    fire_only_once = yes
	
    mean_time_to_happen = { months = 2 }

    immediate = {
    	set_country_flag = first_peace_of_thorn
	}
    
	option = {
	    ai_chance = { factor = 65 }
		name = "flavor_pol.7221.a" #Peace with Teutons
		white_peace = TEU
		every_known_country = {
		limit = {
		    is_subject_of = LIT
			}
            add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
			}
			add_liberty_desire = -50
		}  
		if = {
				limit = { 
					 TEU = { owns = 1265 } #Semigalia
			    }	 
			    1265 = {
					cede_province = PLC
		            add_core = PLC
			    }
		}
		if = {
				limit = { 
					 TEU = { owns = 1280 } #Suvalkija
			    }	 
			    1280 = {
					cede_province = PLC
		            add_core = PLC
			    }
		}
		if = {
				limit = { 
					 TEU = { owns = 3397 } #Upper Lithuania/Kaunas
			    }	 
			    3397 = {
					cede_province = PLC
		            add_core = PLC
			    }
		}
		TEU = { 
		    add_treasury = -500
			set_country_flag = broken_by_polish
		}
		add_treasury = 500
		hidden_effect = {
			PLC = {
				every_owned_province = {
					remove_claim = TEU
					remove_core = TEU
				}
			}
			every_known_country = {
				limit = {
					is_subject_of = PLC
					}
					every_owned_province = {
						remove_claim = TEU
						remove_core = TEU
					}
			}  
		}
	}

    option = {
	    ai_chance = { factor = 30 }
		name = "flavor_pol.7221.b" #Peace with Teutons, but demand Chełmno
		white_peace = TEU
		2398 = { #Chelmno
			if = {
				limit = {
                    owned_by = TEU
				}
				cede_province = POL
				add_core = POL
				remove_core = TEU
			}
		}
		every_known_country = {
		limit = {
		    is_subject_of = PLC
			}
            add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
			}
			add_liberty_desire = -50
		}  
		if = {
				limit = { 
					 TEU = { owns = 1265 } #Semigalia
			    } 
			    1265 = {
					cede_province = PLC
		            add_core = PLC
			    }
		}
		if = {
				limit = { 
					 TEU = { owns = 1280 } #Suvalkija
			    }	 
			    1280 = {
					cede_province = PLC
		            add_core = PLC
			    }
		}
		if = {
				limit = { 
					 TEU = { owns = 3397 } #Upper Lithuania/Kaunas
			    }	 
			    3397 = {
					cede_province = PLC
		            add_core = PLC
			    }
		}
		add_country_modifier = { 
		     name = diplo_faux_pas
			 duration = 3650
		}	 
		TEU = {
			set_country_flag = broken_by_polish
		}
		hidden_effect = {
		PLC = {
			every_owned_province = {
				remove_claim = TEU
				remove_core = TEU
			}
		}
		every_known_country = {
			limit = {
				is_subject_of = PLC
				}
				every_owned_province = {
					remove_claim = TEU
					remove_core = TEU
				}
			}  
		}
	}
     
	option = {
	    ai_chance = { factor = 5 }
		name = "flavor_pol.7221.c" #Continue fighting
		every_known_country = {
		    limit = {
				is_subject_of = PLC
			}
            add_opinion = {
				who = ROOT
				modifier = not_peaced_with_teutons
			}
			add_liberty_desire = 50
		}
		add_war_exhaustion = 5 
		hidden_effect = {
		every_known_country = {
			limit = {
				religion = catholic
				capital_scope = {
			        OR = {
				        superregion = germany_superregion
				        superregion = greater_austrian_circle_superregion
			        }
		        }
			}	
			add_opinion = {
				who = ROOT
				modifier = not_peaced_with_teutons
			}
			set_country_flag = refused_peace_of_thorn
			}
		}
	}
}

country_event = {		#POL no LIT version
	id = flavor_pol.7222
	title = "flavor_pol.7221.title"
	desc = "flavor_pol.7221.desc"
	picture = SIEGE_eventPicture
    major = yes
    trigger = { 
        tag = POL
		NOT = { 
			LIT = {
				is_subject_of = POL
				OR = {
					is_subject_of_type = permanent_union 
					is_subject_of_type = permanent_union_limited
				}
			}
		 }
		TEU = { NOT = { has_country_flag = broken_by_polish } }
		NOT = { has_country_flag = first_peace_of_thorn }
		NOT = { has_global_flag = lithuanian_civil_war	}
		war_score_against = {
	        who = TEU
	        value = 40
        }
	}
    fire_only_once = yes
	
    mean_time_to_happen = { months = 2 }	

    immediate = {
    	set_country_flag = first_peace_of_thorn
	}	
    
	option = {
	    ai_chance = { factor = 65 }
		name = "flavor_pol.7222.a" #Peace with Teutons
		white_peace = TEU
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = 10 } 
		every_known_country = {
		limit = {
		    is_subject_of = POL
			}
            add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
			}		
			add_liberty_desire = -50
		}  
		if = {
				limit = { 
					 TEU = { owns = 1265 } #Semigalia
			    }	 
			    1265 = {
					cede_province = POL
		            add_core = POL
			    }
		}
		if = {
				limit = { 
					 TEU = { owns = 1280 } #Suvalkija
			    }	 
			    1280 = {
					cede_province = POL
		            add_core = POL
			    }
		}
		if = {
				limit = { 
					 TEU = { owns = 3397 } #Upper Lithuania/Kaunas
			    }	 
			    3397 = {
					cede_province = POL
		            add_core = POL
			    }
		}
		TEU = { 
		    add_treasury = -500
			set_country_flag = broken_by_polish
		}
		add_treasury = 500
		hidden_effect = {
			POL = {
				every_owned_province = {
					remove_claim = TEU
					remove_core = TEU
				}
			}
			every_known_country = {
				limit = {
					is_subject_of = POL
					}
					every_owned_province = {
						remove_claim = TEU
						remove_core = TEU
					}
			}  
		}
	}

    option = {
	    ai_chance = { factor = 30 }
		name = "flavor_pol.7222.b" #Peace with Teutons, but demand Chełmno
		white_peace = TEU
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = 5 }
		2398 = { #Chelmno
			if = {
				limit = {
                    owned_by = TEU
				}	
				cede_province = POL
				add_core = POL
				remove_core = TEU
			}
		}
		every_known_country = {
		limit = {
		    is_subject_of = POL
			}
            add_opinion = {
				who = ROOT
				modifier = peaced_with_teutons
			}		
			add_liberty_desire = -50
		}  
		if = {
				limit = { 
					 TEU = { owns = 1265 } #Semigalia
			    }	 
			    1265 = {
					cede_province = POL
		            add_core = POL
			    }
		}
		if = {
				limit = { 
					 TEU = { owns = 1280 } #Suvalkija
			    }	 
			    1280 = {
					cede_province = POL
		            add_core = POL
			    }
		}
		if = {
				limit = { 
					 TEU = { owns = 3397 } #Upper Lithuania/Kaunas
			    }	 
			    3397 = {
					cede_province = POL
		            add_core = POL
			    }
		}
		add_country_modifier = { 
		     name = diplo_faux_pas
			 duration = 3650
		}	 
		TEU = {
			set_country_flag = broken_by_polish
		}
		hidden_effect = {
		POL = {
			every_owned_province = {
				remove_claim = TEU
				remove_core = TEU
			}
		}
		every_known_country = {
			limit = {
				is_subject_of = POL
				}
				every_owned_province = {
					remove_claim = TEU
					remove_core = TEU
				}
			}  
		}
	}
     
	option = {
	    ai_chance = { factor = 5 }
		name = "flavor_pol.7222.c" #Continue fighting
		every_known_country = {
		    limit = {
				is_subject_of = POL
			}
            add_opinion = {
				who = ROOT
				modifier = not_peaced_with_teutons
			}
			add_liberty_desire = 50
		}
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = -10 } 
		add_war_exhaustion = 5 
		hidden_effect = {
		every_known_country = {
			limit = {
				religion = catholic
				capital_scope = {
			        OR = {
				        superregion = germany_superregion
				        superregion = greater_austrian_circle_superregion
			        }
		        }
			}	
			add_opinion = {
				who = ROOT
				modifier = not_peaced_with_teutons
			}
			set_country_flag = refused_peace_of_thorn
			}
		}
	}
}

## RISE OF PRUSSIAN CONFEDERATION ##

country_event = {			#POL version
	id = flavor_pol.751
	title = "flavor_teu.EVTNAME1"
	desc = "flavor_teu.EVTDESC1"
	picture = BATTLE_VISTULA_LAGOON_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = TEU
		has_country_flag = pru_confederation_prepare
		NOT = { truce_with = POL }
		is_subject = no
		OR = {
			43 = { #Puck
				country_or_non_sovereign_subject_holds = ROOT 
			}     
			1391 = { #Ermland
				country_or_non_sovereign_subject_holds = ROOT 
			}
			1844 = { #Marienburg
				country_or_non_sovereign_subject_holds = ROOT 
			}
			2355 = { #Danzig
				country_or_non_sovereign_subject_holds = ROOT 
			}
			2845 = { #Lauenburg-Butow
				country_or_non_sovereign_subject_holds = ROOT 
			}
			4025 = { #Techolo
				country_or_non_sovereign_subject_holds = ROOT 
			}
		}
		exists = POL
		NOT = { exists = PLC }
		is_neighbor_of = POL
		NOT = { war_with = POL }
		NOT = { alliance_with = POL }
		POL = { is_subject = no }
		POL = { num_of_cities = 10 }
		num_of_cities = 5
	}
	
	mean_time_to_happen = {
		years = 2
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = pru_confederation_happened
			every_owned_province = {
				limit = {
					area = west_prussia_area 
					owned_by = TEU
				}
				cede_province = DNZ
				add_core = DNZ
			}
			if = {
				limit = {
					NOT = {
						exists = DNZ
					}
				}
				release = DNZ
				DNZ = {  
					Pol_ChangeGovRepublic = { Mandate=1 Stylings=1 ExtraPowers=1 Assembly=2 TermOfOffice=5 } 
					add_government_reform = Pol_Nobility2
				}
				DNZ = {
					capital_scope = {
						build_to_forcelimit = {
							infantry = 0.6
							cavalry = 0.3
						}
					}
					random_owned_province = {
						limit = {
							has_port = yes
						}
						build_to_forcelimit = {
							galley = 0.3
							light_ship = 0.3
							transport = 0.2
						}
					}
				}
			}
		}
	}
	
	option = { # Go to war
		name = "flavor_pol.751.a"
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					is_bankrupt = yes
					war_exhaustion = 10
				}
			}
			 
		}
		custom_tooltip = flavor_pol.751.tooltip
		hidden_effect = {
			POL = {
				country_event = { id = flavor_pol.752 }
			}
			POL = {
				create_guarantee = DNZ
			}
		}
	}
	option = { # Let them go
		name = "flavor_pol.751.b"
		ai_chance = { 
			factor = 100 
			modifier = {
				factor = 0
				OR = {
					is_bankrupt = no
					NOT = { war_exhaustion = 10 }
				}
			}
		}
		Stab_Subtract1 = yes
		add_prestige = -20
	}
}

country_event = {
	id = flavor_pol.7511
	title = "flavor_teu.EVTNAME1"
	desc = "flavor_teu.EVTDESC1"
	picture = BATTLE_VISTULA_LAGOON_eventPicture
	
	fire_only_once = yes
	
	trigger = {
		tag = TEU
		has_country_flag = pru_confederation_prepare
		NOT = { truce_with = PLC }
		is_subject = no
		OR = {
			43 = { #Puck
				country_or_non_sovereign_subject_holds = ROOT 
			}     
			1391 = { #Ermland
				country_or_non_sovereign_subject_holds = ROOT 
			}
			1844 = { #Marienburg
				country_or_non_sovereign_subject_holds = ROOT 
			}
			2355 = { #Danzig
				country_or_non_sovereign_subject_holds = ROOT 
			}
			2845 = { #Lauenburg-Butow
				country_or_non_sovereign_subject_holds = ROOT 
			}
			4025 = { #Techolo
				country_or_non_sovereign_subject_holds = ROOT 
			}
		}
		exists = PLC
		is_neighbor_of = PLC
		NOT = { war_with = PLC }
		NOT = { alliance_with = POL }
		PLC = { is_subject = no }
		PLC = { num_of_cities = 10 }
		num_of_cities = 5
	}
	
	mean_time_to_happen = {
		years = 2
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = pru_confederation_happened
			every_owned_province = {
				limit = {
					area = west_prussia_area 
					owned_by = TEU
				}
				cede_province = DNZ
				add_core = DNZ
			}
			if = {
				limit = {
					NOT = {
						exists = DNZ
					}
				}
				release = DNZ
				DNZ = {  
					Pol_ChangeGovRepublic = { Mandate=1 Stylings=1 ExtraPowers=1 Assembly=2 TermOfOffice=5 } 
					add_government_reform = Pol_Nobility2
				}
				DNZ = {
					capital_scope = {
						build_to_forcelimit = {
							infantry = 0.6
							cavalry = 0.3
						}
					}
					random_owned_province = {
						limit = {
							has_port = yes
						}
						build_to_forcelimit = {
							galley = 0.3
							light_ship = 0.3
							transport = 0.2
						}
					}
				}
			}
		}
	}
	
	option = { # Go to war
		name = "flavor_pol.751.a"
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					is_bankrupt = yes
					war_exhaustion = 10
				}
			}
			 
		}
		custom_tooltip = flavor_pol.751.tooltip
		hidden_effect = {
			PLC = {
				country_event = { id = flavor_pol.752 }
			}
			PLC = {
				create_guarantee = DNZ
			}
		}
	}
	option = { # Let them go
		name = "flavor_pol.751.b"
		ai_chance = { 
			factor = 100 
			modifier = {
				factor = 0
				OR = {
					is_bankrupt = no
					NOT = { war_exhaustion = 10 }
				}
			}
		}
		Stab_Subtract1 = yes
		add_prestige = -20
	}
}

## PRUSSIAN CONFEDERATION SEEKS POLISH SUPPORT ##

country_event = {
	id = flavor_pol.752
	title = "flavor_teu.EVTNAME2"
	desc = "flavor_teu.EVTDESC2"
	picture = BATTLE_VISTULA_LAGOON_eventPicture
	
	fire_only_once = yes
	
	is_triggered_only = yes
	
	major = yes
	
	option = {
		name = "flavor_pol.752.a"
		ai_chance = {
			factor = 100
			modifier = {
				factor = 0
				OR = {
					is_bankrupt = yes
					war_exhaustion = 10
				}
			}
		}
		set_country_flag = supported_prussian_confederation_flag
		add_opinion = {
			who = DNZ
			modifier = supported_prussian_confederation
		}
		DNZ = {
			add_opinion = {
				who = ROOT
				modifier = supported_prussian_confederation
			}
		}
		create_alliance = DNZ
		
		# if = {
	    #     limit = {
		# 	    WRM = {
		# 		    exists = yes
		# 			is_subject_of = TEU
		# 		}
		# 	}
		# 	WRM = { set_country_flag = subject_of_teu }
	    # }
		TEU = {
				country_event = { id = flavor_pol.754 }
		}
	}
	option = { # stay out of this
		name = "flavor_pol.752.b"
		ai_chance = { 
			factor = 100
			modifier = {
				factor = 0
				OR = {
					is_bankrupt = no
					NOT = { war_exhaustion = 10 }
				}
			}
		}
		add_prestige = -10
		TEU = {
				country_event = { id = flavor_pol.754 }
		}
	}
}

## PRUSSIAN CONFEDERATION - BEGINNING ##

country_event = {
	id = flavor_pol.753
	title = "flavor_teu.EVTNAME4"
	desc = "flavor_teu.EVTDESC4"
	picture = SEJM_eventPicture
	
	fire_only_once = yes
	major = yes
	
	trigger = {
		tag = TEU
		has_country_flag = broken_by_polish
	}
	
	mean_time_to_happen = {
		years = 5
	}
	
	option = {
		name = "flavor_pol.753.a"
		set_country_flag = pru_confederation_prepare
	}
}

## WAR WITH PRUSSIAN CONFEDERATION ##

country_event = {
	id = flavor_pol.754
	title = "flavor_pol.754.title"
	desc = "flavor_pol.754.desc"
	picture = SEJM_eventPicture
	
	fire_only_once = yes
	is_triggered_only = yes
	
	option = {
		name = "flavor_pol.754.a"
		declare_war_with_cb = {
			who = DNZ
			casus_belli = cb_disloyal_vassal
		}
	}
}

#Vanilla flavor_teu files ported by Mepper to complete the event chain:

# Prussian Confederation accepts Polish rule
country_event = {
	id = flavor_teu.3
	title = "flavor_teu.EVTNAME3"
	desc = "flavor_teu.EVTDESC3"
	picture = SEJM_eventPicture
	
	fire_only_once = yes
	
	is_triggered_only = yes
	
	option = {
		name = "flavor_teu.3.a"
		vassalize = DNZ
		if = {
			limit = {
				2398 = { #Chelmno
					owned_by = DNZ
					culture = polish
				}
			}
			2398 = {
				cede_province = ROOT
				add_core = ROOT
				remove_core = DNZ
			}
		}
		west_prussia_area = {
			limit = {
				NOT = { is_permanent_claim = ROOT }
				NOT = { is_core = ROOT	}
				NOT = { is_permanent_claim = DNZ }
				NOT = { is_core = DNZ }
			}
			add_permanent_claim = ROOT
		}
	}
}

# # The Prussian Confederation
# country_event = {
# 	id = flavor_teu.4
# 	title = "flavor_teu.EVTNAME4"
# 	desc = "flavor_teu.EVTDESC4"
# 	picture = SEJM_eventPicture
	
# 	fire_only_once = yes
	
# 	trigger = {
# 		tag = TEU
# 		NOT = {
# 			is_year = 1450
# 		}
# 		NOT = { has_country_flag = pru_confederation_flag }
# 	}
	
# 	mean_time_to_happen = {
# 		days = 1
# 	}
	
# 	option = {
# 		name = "flavor_teu.4.a"
# 		set_country_flag = pru_confederation_flag
# 		custom_tooltip = dnz_decision_available_tooltip
# 		add_estate_loyalty = {
# 			estate = estate_burghers
# 			loyalty = -20
# 		}
# 		add_estate_influence_modifier = {
# 			estate = estate_burghers
# 			desc = EST_VAL_PRUSSIAN_CONFEDERATION
# 			influence = 10
# 			duration = 7300
# 		}
# 		give_estate_land_share_gigantic = { estate = estate_burghers }
# 	}
# }
	
# The End of the Teutonic State
country_event = {
	id = flavor_teu.5
	title = flavor_teu.5.t
	desc = flavor_teu.5.d
	picture = SEJM_eventPicture
	
	trigger = {
		is_year = 1460
		NOT = { is_year = 1500 }
		tag = TEU
		NOT = { has_country_flag = pru_confederation_curtailed }
		has_country_flag = pru_confederation_flag
		#has_estate_privilege = estate_burghers_prussian_confederation
		is_subject = no
		is_at_war = no
		NOT = {
			exists = DNZ
		}
	}
	
	mean_time_to_happen = {
		years = 12
	}
	
	option = {
		name = flavor_teu.5.a
		clr_country_flag = pru_confederation_flag
		change_tag = DNZ
		Pol_ChangeGovRepublic = { Mandate=1 Stylings=1 ExtraPowers=1 Assembly=2 TermOfOffice=5 } 
		add_government_reform = Pol_Nobility2
		#remove_estate_privilege = estate_burghers_prussian_confederation
		Stab_Subtract1 = yes
		add_prestige = -25
		hidden_effect = {
			country_event = {
				id = ideagroups.9000
				days = 1
			}
		}
		custom_tooltip = swap_national_ideas
	}
}

############################
##### COSSACK UPRISING #####
############################	
#Ported from DeI Ludicrum submod by Piterdaw

## COSSACK CONVERSION ##
province_event = {
    id = flavor_pol.735
	title = "flavor_pol.735.title"
	desc = "flavor_pol.735.d"
	picture = COSSACK_ESTATE_UPSET_eventPicture
	hidden = yes
	trigger = {
		#is_year = 1492
		OR = {
			area = zaporizhia_area
			area = sloboda_ukraine_area
			area = lower_don_area
			area = azov_area
		}
		check_key = { lhs = Prov_TRPow value = 50 }
		OR = {
			culture = crimean 
			culture = tartar
		}
		owner = {
			OR = {
				tag = POL
				tag = PLC
				religion = orthodox
			}
		}
		any_neighbor_province = {
			OR = {
				culture = ukrainian
				culture = ruthenian
				culture = russian
			}
		}
	}
	
	mean_time_to_happen = { years = 30 }
	
	option = {
		name = "flavor_pol.735.a"
		if = {
			limit = { area = zaporizhia_area }
			add_core = ZAZ
		}
		change_religion = orthodox
		change_culture = ukrainian
		log = "FE-POL:[GetYear]:[Root.Owner.GetName]:[This.GetName] converted to Cossack culture:flavor_pol.735"
	}
}

## NALEWAJKO UPRISING ##
	
country_event = {
	id = flavor_pol.740
	title = "flavor_pol.740.title"
	desc = "flavor_pol.740.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
    fire_only_once = yes
	
	trigger = {
	    OR = {
			tag = PLC
			AND = {
				tag = POL
				NOT = { exists = PLC }
			}
		}
	    any_owned_province = {
		    culture = ukrainian
			area = zaporizhia_area
		}
        NOT = { stability = 2 }
        is_year = 1550
        NOT = { is_year = 1650 }
	}
	
	mean_time_to_happen = {
		years = 5
	}
	
	option = { #Put down the insurrection
        name = "flavor_pol.740.a"
		set_country_flag = nalewajko_uprising
        Stab_Subtract1 = yes
		log = "FE-POL:[GetYear]:[Root.GetName]:Nalevajko uprising of Cossacks started:flavor_pol.740"
		random_owned_province = {
			limit = {
				culture = ukrainian
			}
			spawn_rebels = {
				type = cossack_rebels
				size = 3
			}
		}
		random_owned_province = {
			limit = {
				culture = ukrainian
			}
			spawn_rebels = {
				type = cossack_rebels
				size = 2
			}
		}
	}
}

## END OF THE UPRISING ##

country_event = {
	id = flavor_pol.741
	title = "flavor_pol.741.title"
	desc = "flavor_pol.741.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
    fire_only_once = yes
	
	trigger = {
	    has_country_flag = nalewajko_uprising
        NOT = { num_of_revolts = 1 }
		NOT = { has_spawned_rebels = cossack_rebels }
	}
	
	mean_time_to_happen = {
		years = 1
	}
	
	immediate = {
	    clr_country_flag = nalewajko_uprising
	}	
    
	option = { #Reach an agreement with Cossacks
        name = "flavor_pol.741.a"
		log = "FE-POL:[GetYear]:[Root.GetName]:Nalevajko uprising ended by reaching an agreement with Cossacks:flavor_pol.741"
		log = "FE-POL:[GetYear]:[Root.GetName]:Cossacks were added to regular army and Sich became a vassal:flavor_pol.741"
		
		Stab_Add1 = yes
		add_country_modifier = {
			name = cossacks_in_regular_army 
			duration = -1
		}
		every_owned_province = {
			limit = {
				area = zaporizhia_area
			}
			cede_province = ZAZ
			add_core = ZAZ
		}
		create_subject = {
			subject_type = decentralized_vassal
			subject = ZAZ
		}
	}
	
	option = { #Crush them once and for all
        name = "flavor_pol.741.b"
		set_country_flag = angered_cossacks
		Stab_Subtract1 = yes
		log = "FE-POL:[GetYear]:[Root.GetName]:Nalevajko uprising ended by crushing the Cossacks:flavor_pol.741"
		random_owned_province = {
			limit = {
				culture = ukrainian
			}
			spawn_rebels = {
				type = cossack_rebels
				size = 2
			}
		}
		random_owned_province = {
			limit = {
				culture = ukrainian
			}
			spawn_rebels = {
				type = cossack_rebels
				size = 2
			}
		}
		every_province = {
			limit = {
				area = zaporizhia_area
				owned_by = ROOT
			}
			add_province_modifier = {
				name = cossack_unrest 
				duration = 36500 #100 years
			} 
		}
	}
}
	
## UNREST ON SICH ##
country_event = {
	id = flavor_pol.742
	title = "flavor_pol.742.title"
	desc = "flavor_pol.742.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
    fire_only_once = yes
	
    is_triggered_only = yes #from chmielnicki_uprising disaster
	
	immediate = {
	    set_country_flag = chmielnicki_uprising
	}	
    
	option = { #Dire times ahead of us
        name = "flavor_pol.742.a"
        Stab_Subtract1 = yes
		remove_country_modifier = cossacks_in_regular_army 
		log = "FE-POL:[GetYear]:[Root.GetName]:Cossacks uprising disaster started:flavor_pol.742"
		log = "FE-POL:[GetYear]:[Root.GetName]:Cossacks removed from regular army:flavor_pol.742"
		log = "FE-POL:[GetYear]:[Root.GetName]:Cossacks unrest and liberty desire added:flavor_pol.742"
		create_subject = {
            subject_type = rebellious_decentralized_vassal
            subject = ZAZ
        }
        ZAZ = { add_liberty_desire = 100 }
        ZAZ = {
            add_opinion = {
				who = ROOT
				modifier = cossack_rebellion
			}
		}
        ROOT = {
            add_opinion = {
				who = ZAZ
				modifier = cossack_rebellion
			}
		}
        ZAZ = { country_event = { id = flavor_pol.743 } }
	}
}

## RISE OF THE NEW COSSACK HETMAN ##
country_event = {
	id = flavor_pol.743
	title = "flavor_pol.743.title"
	desc = "flavor_pol.743.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
    fire_only_once = yes
	
    is_triggered_only = yes
	
	immediate = {
	    set_country_flag = rebellious_hetman
		if = {
		    limit = { 
			    is_year = 1620
                NOT = { is_year = 1657 }
			}
            set_country_flag = bohdan_chmielnicki
		}
	}	
    
	option = { #Long live our hetman!
        name = "flavor_pol.743.a"
        Stab_Add3 = yes
		if = {
		    limit = {
			    has_country_flag = bohdan_chmielnicki
			}
			log = "FE-POL:[GetYear]:[Root.GetName]:rebellious hetman is Bogdam Chmielnicki:flavor_pol.743"
            define_ruler = {
			    name = "Bohdan Chmielnicki"
			    claim = 100
			    adm = 5
			    dip = 6
			    mil = 6
				max_random_adm = 5
			    min_age = 25
				max_age = 45
			    culture = ruthenian
			    religion = orthodox
		   }
		   define_ruler_to_general = {
                fire = 5
                shock = 5
                manuever = 5
                siege = 2
           }
           add_ruler_personality = brilliant_strategist_personality
		   add_ruler_personality = deceitful_personality
		   add_ruler_personality = drunkard_personality
		}
        if = {
		    limit = {
			    NOT = { has_country_flag = bohdan_chmielnicki }
			}
            define_ruler = {
			    claim = 90
			    adm = 4
			    dip = 5
			    mil = 5
				max_random_adm = 4
				max_random_dip = 5
				max_random_mil = 5
			    age = 35
			    culture = ruthenian
			    religion = orthodox
		   }
		   define_ruler_to_general = {
                fire = 4
                shock = 4
                manuever = 4
                siege = 1
           }
           add_ruler_personality = martial_educator_personality
		}
        define_general = {
		    name = "Ivan Bohun"
            shock = 4
            fire = 4
            manuever = 6
            siege = 2
        }
        add_country_modifier = {
				name = chmielnicki_uprising
				duration = 7300 #20 years
		}
	}
}

## CHMIELNICKI UPRISING ##
country_event = {
	id = flavor_pol.744
	title = "flavor_pol.744.title"
	desc = "flavor_pol.744.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
	major = yes
	
    trigger = {
	    has_country_flag = chmielnicki_uprising
	}	
	
	mean_time_to_happen = { months = 3 }
    
	fire_only_once = yes
	
	option = { #Crush those peasants!
        name = "flavor_pol.744.a"
		set_country_flag = chmielnicki_uprising_2
		log = "FE-POL:[GetYear]:[Root.GetName]:angry mob spawned:flavor_pol.744"
		every_owned_province = {
		    limit = {
			    OR = {
			        area = east_dniepr_area
				    area = zaporizhia_area
				    area = sloboda_ukraine_area
				    area = azov_area
				    area = lower_don_area
				    area = briansk_area
                    area = crimea_area 
				}
			}
			spawn_rebels = {
				type = mob_rebels
				size = 1
			}
        }
		
        every_owned_province = {
		    limit = {
				area = west_dniepr_area
			}
			spawn_rebels = {
				type = cossack_rebels
				size = 2
			}
        }
        
        if = {
		    limit = { 
			    is_year = 1630
				NOT = { is_year = 1651 } 
			}
			log = "FE-POL:[GetYear]:[Root.GetName]:Jeremi Wisniowiecki became general:flavor_pol.744"
			define_general = {
		        name = "Jeremi Wisniowiecki"
                shock = 5
                fire = 4
                manuever = 4
                siege = 3
            }
        }
	}
}

## PROVINCE DEFECTS TO COSSACKS ##
province_event = {
	id = flavor_pol.745
	title = "flavor_pol.745.title"
	desc = "flavor_pol.745.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
    hidden = yes
	
    trigger = {
	    owner = {
	        has_country_flag = chmielnicki_uprising
            NOT = { has_country_flag = agreement_of_pereyeslavl }
		}
        OR = {
            culture = ruthenian
            culture = ukrainian
			culture = russian
		}
		NOT = {
		    area = red_ruthenia_area
			area = smolensk_area
			area = polesie_area
			area = black_ruthenia_area
			area = white_ruthenia_area
		}
        any_neighbor_province = {
            owned_by = ZAZ
		}
        controlled_by = REB
	}
	
	mean_time_to_happen = { months = 1 }
    
	option = { 
        name = "flavor_pol.745.a"
		log = "FE-POL:[GetYear]:[Root.GetName]:[This.GetName] defected to Cossacks:flavor_pol.745"
       	cede_province = ZAZ
		add_core = ZAZ
        ZAZ = {
		    disband_rebels = mob_rebels
			disband_rebels = cossack_rebels
        }
	}
}

## NEGOTIATIONS OF AGREEMENT ##
country_event = {
	id = flavor_pol.746
	title = "flavor_pol.746.title"
	desc = "flavor_pol.746.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
	fire_only_once = yes
	
    trigger = {
	    tag = ZAZ
	    OR = {
		    POL = { has_country_flag = chmielnicki_uprising_2 }
		    PLC = { has_country_flag = chmielnicki_uprising_2 }
		}
        OR = {
            AND = { 
			    exists = MOS
                MOS = { is_subject = no }
				MOS = { total_development = 400 }
				NOT = { MOS = { alliance_with = POL } }
			    NOT = { MOS = { alliance_with = PLC } }
			}
			AND = { 
			    exists = RUS
				RUS = { is_subject = no }	
				RUS = { total_development = 400 }
				NOT = { RUS = { alliance_with = POL } }
			    NOT = { RUS = { alliance_with = PLC } }
			}
			AND = { 
			    exists = TUR
                TUR = { is_subject = no }
				TUR = { total_development = 600 }
				NOT = { TUR = { alliance_with = POL } }
			    NOT = { TUR = { alliance_with = PLC } }
			}
		}
	}	
	
	immediate = {
	    if = {
		    limit = {
			    exists = MOS
                MOS = { is_subject = no }
				MOS = { total_development = 400 }
				NOT = { MOS = { alliance_with = POL } }
			    NOT = { MOS = { alliance_with = PLC } }
				OR = {
					NOT = { exists = RUS }
					AND = {
						exists = RUS
						MOS = { total_development = RUS }
					}
				}
			}
            set_country_flag = strong_muscovy
			log = "FE-POL:[GetYear]:[Root.GetName]:Muscovy recognised as potential overlord:flavor_pol.746"
		}
        if = {
		    limit = {
			    exists = RUS
				RUS = { is_subject = no }	
				RUS = { total_development = 400 }
				NOT = { RUS = { alliance_with = POL } }
			    NOT = { RUS = { alliance_with = PLC } }
				OR = {
					NOT = { exists = MOS }
					OR = {
						exists = MOS
						RUS = { total_development = MOS }
					}
				}
			}
            set_country_flag = strong_russia
			log = "FE-POL:[GetYear]:[Root.GetName]:Russia recognised as potential overlord:flavor_pol.746"
		}
	}
	
	mean_time_to_happen = {
		years = 4
		modifier = {
			factor = 0.25
			is_at_war = yes
		}
	}
    
	option = { #Swore our allegiance to Muscovites
        name = "flavor_pol.746.a"
       	ai_chance = { factor = 70 }
        trigger = { 
            has_country_flag = strong_muscovy
			NOT = { MOS = { alliance_with = POL } }
			NOT = { MOS = { alliance_with = PLC } }
		}
        MOS = { country_event = { id = flavor_pol.747 days = 1 } }
        grant_independence = yes
		log = "FE-POL:[GetYear]:[Root.GetName]:swore allegiance to Muscovy:flavor_pol.746"
	}
	
	option = { #Swore our allegiance to Russians
        name = "flavor_pol.746.b"
       	ai_chance = { factor = 70 }
        trigger = { 
            has_country_flag = strong_russia
			NOT = { RUS = { alliance_with = POL } }
			NOT = { RUS = { alliance_with = PLC } }
		}
        RUS = { country_event = { id = flavor_pol.747 days = 1 } }
        grant_independence = yes
		log = "FE-POL:[GetYear]:[Root.GetName]:swore allegiance to Russia:flavor_pol.746"
	}
	
	option = { #Swore our allegiance to Sultan
        name = "flavor_pol.746.c"
       	ai_chance = { factor = 30 }
        trigger = { 
            exists = TUR 
			TUR = { total_development = 600 }
			NOT = { TUR = { alliance_with = POL } }
			NOT = { TUR = { alliance_with = PLC } }
		}
        TUR = { country_event = { id = flavor_pol.747 days = 1 } }
        grant_independence = yes
		log = "FE-POL:[GetYear]:[Root.GetName]:swore allegiance to the Turkish Empire:flavor_pol.746"
	}
}

## NEGOTIATIONS WITH COSSACKS ##
country_event = {
	id = flavor_pol.747
	title = "flavor_pol.747.title"
	desc = "flavor_pol.747.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
	fire_only_once = yes
    is_triggered_only = yes
	
	immediate = {
	    set_country_flag = cossack_overlord
	}

	option = { #Welcome them with open arms
        name = "flavor_pol.747.a"
		create_subject = {
            subject_type = decentralized_vassal
            subject = ZAZ
        }
		add_country_modifier = {
			name = cossacks_in_regular_army 
			duration = -1
		}
        every_known_country = {
		    limit = { has_country_flag = chmielnicki_uprising_2 }
			country_event = { id = flavor_pol.748 } 
        }
	}
}

## COUNCIL OF PEREYESLAVL ##
country_event = {
	id = flavor_pol.748
	title = "flavor_pol.748.title"
	desc = "flavor_pol.748.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
	fire_only_once = yes
    is_triggered_only = yes
	major = yes
	
	immediate = {
	    set_country_flag = agreement_of_pereyeslavl
	}

	option = { #Traitor, not a hetman!
        name = "flavor_pol.748.a"
		log = "FE-POL:[GetYear]:[Root.GetName]:was forced to cede Cossack provinces by agreement of Pereyeslavl:flavor_pol.748"
		every_owned_province = {
		    limit = {
			    OR = {
				    area = west_dniepr_area
			        area = east_dniepr_area
				    area = zaporizhia_area
				    area = sloboda_ukraine_area
				}
			}
			cede_province = ZAZ
        }
		ZAZ = {
		    every_owned_province = { add_core = ROOT }
        }
        ROOT = {
		    disband_rebels = mob_rebels
			disband_rebels = cossack_rebels
        }
	}
}

## UNION OF HADZIACZ ##
country_event = {
	id = flavor_pol.749
	title = "flavor_pol.749.title"
	desc = "flavor_pol.749.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
	fire_only_once = yes
    major = yes
	
	trigger = {
	    has_country_flag = agreement_of_pereyeslavl
		monarchy_or_harem_gov = yes
		NOT = { war_with = ZAZ }
	}
	
	mean_time_to_happen = { years = 5 }
	
	immediate = {
		hidden_effect = {
			Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = 15 } #TODO: check why, seems out of place
		}
	}

	option = { #Make this union come true!
        name = "flavor_pol.749.a"
		log = "FE-POL:[GetYear]:[Root.GetName]:signed Union of Hadziacz:flavor_pol.749"
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = -10 }
        ZAZ = { change_tag = UKR }
        create_subject = {
               subject_type = permanent_union
               subject = UKR
        }
		UKR = {
            add_opinion = {
				who = ROOT
				modifier = union_of_hadziacz
			}
		}
        ROOT = {
            add_opinion = {
				who = UKR
				modifier = union_of_hadziacz
			}
		}
		every_owned_province = {
		    limit = {
			    OR = {
				    area = west_dniepr_area
			        #area = east_dniepr_area 
					province_id = 299 #Pereyaslavl
					province_id = 4943 #Oster
					province_id = 289 #Chernihiv
					province_id = 311 #Starodub
				    area = lower_don_area
				    region = crimea_region 
				}
			}
			cede_province = UKR
		    add_core = UKR
        }
		UKR = { 
            Pol_ChangeGovMonarchy = { Succession=1 Assembly=2 } 
			add_government_reform = Pol_Nobility3
		}
        every_known_country = {
		    limit = { has_country_flag = cossack_overlord }
			remove_country_modifier = cossacks_in_regular_army 
            add_opinion = {
				who = ROOT
				modifier = cossack_rebellion
			}
			clr_country_flag = cossack_overlord
		}	
		hidden_effect = {
			UKR = { 
				add_accepted_culture = ukrainian
				add_accepted_culture = polish
				change_title_5 = yes
				if = {
					limit = {
						owns = 280 #Kyiv
						NOT = { capital = 280 }			
					}
					Effect_set_capital = { target= 280 }
					log = "FE-POL:[GetYear]:[UKR.GetName]:moved capital to [280.GetName]:flavor_pol.749"
				}
				else_if = {
					limit = {
						capital_scope = {
							NOT = { development = 5 }
							NOT = { province_id = 280 }
						}
						any_owned_province = {
							development = 7
						}
					}
					random_owned_province = {
						limit = {
							development = 7
						}
						save_event_target_as = potential_ruthenia_capital
					}
					Effect_set_capital = { target= event_target:potential_ruthenia_capital }
					log = "FE-POL:[GetYear]:[UKR.GetName]:moved capital to [UKR.Capital.GetName]:flavor_pol.749"
				}
            }
		}	
	}
	option = { #No mercy for traitors!
        name = "flavor_pol.749.b"
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = 15 }
		log = "FE-POL:[GetYear]:[Root.GetName]:refused Union of Hadziacz:flavor_pol.749"
        add_prestige = 20
        #add_mil_power = 200
	}
	option = { #Give up ukrainian lands
        name = "flavor_pol.749.c"
		Public_ChangePowerbrokerLoyaltyTooltipProv = { Powerbroker = NO Amount = -15 }
		log = "FE-POL:[GetYear]:[Root.GetName]:refused Union of Hadziacz and gave up Ukraine:flavor_pol.749"
        add_prestige = -20
		ZAZ = {
		    every_owned_province = {
			    remove_core = ROOT #TODO: remove claim, too?
			}
		}
        set_country_flag = gave_up_ukraine
	}
}

## END OF THE CHMIELNICKI UPRISING ##
country_event = {
	id = flavor_pol.750
	title = "flavor_pol.750.title"
	desc = "flavor_pol.750.desc"
	picture = COSSACK_ESTATE_UPSET_eventPicture
	fire_only_once = yes
    is_triggered_only = yes #from end of the disaster
	major = yes
	
	immediate = {
	    clr_country_flag = chmielnicki_uprising
        clr_country_flag = chmielnicki_uprising_2
        clr_country_flag = agreement_of_pereyeslavl
	}

	option = { #Peace at last!
        name = "flavor_pol.748.a"
        Stab_Add2 = yes	
	}
}

country_event = {
	id = flavor_pol.5100 #Nicolaus Copernicus
	title = "flavor_pol.EVTNAME5100"
	desc = "flavor_pol.EVTDESC5100"
	picture = ADVISOR_eventPicture
	fire_only_once = yes

	trigger = {
		owns = 2398 	#Kulm/Torun province
		is_year = 1500
		NOT = { is_year = 1543 }
	}
	mean_time_to_happen = {
		years = 5
	}
	option = {
		name = "EXCELLENTCMNISTER"
		add_prestige = 10
		define_advisor = {
			type = astronomist_BG
			name = "Nicolaus Copernicus"
			skill = 3
			discount = yes
		}
	}
}

#Triggered by missions:
country_event = {
	id = flavor_pol.1
	title = "flavor_pol.EVTNAME1"
	desc = "flavor_pol.EVTDESC1"
	picture = NAVAL_MILITARY_eventPicture
	
	is_triggered_only = yes
	fire_only_once = yes
		
	option = {
		name = "flavor_pol.EVTOPTA1" # Build a Great Navy
		add_prestige = 10
		add_navy_tradition = 5
		add_dip_power = 50
		add_treasury = -100

		random_owned_province = {
			limit = { has_port = yes }
			heavy_ship = ROOT
		}
		random_owned_province = {
			limit = { has_port = yes }
			heavy_ship = ROOT
		}
		random_owned_province = {
			limit = { has_port = yes }
			heavy_ship = ROOT
		}
	}
	option = {
		name = "flavor_pol.EVTOPTB1" # Abandon the plans
		add_prestige = -5
	}
}